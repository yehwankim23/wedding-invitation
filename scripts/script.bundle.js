/*! For license information please see script.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n,r,s,i={99:(t,e,n)=>{n.d(e,{cY:()=>d,FA:()=>D,g:()=>A,dM:()=>I,u:()=>a,Uj:()=>o,p9:()=>P,Fy:()=>m,bD:()=>k,T9:()=>h,yU:()=>l,mS:()=>c,Ku:()=>F,ZQ:()=>v,sr:()=>E,zJ:()=>f,zW:()=>S,nr:()=>T,Ov:()=>_,gE:()=>p,P1:()=>w,eX:()=>C});const r=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++r)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const s=t[e],i=e+1<t.length,o=i?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=s>>2,l=(3&s)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,i||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(i>>10)),e[r++]=String.fromCharCode(56320+(1023&i))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==a||null==c)throw new i;const u=s<<2|o>>4;if(r.push(u),64!==a){const t=o<<4&240|a>>2;if(r.push(t),64!==c){const t=a<<6&192|c;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){return function(t){const e=r(t);return s.encodeByteArray(e,!0)}(t).replace(/\./g,"")},a=function(t){try{return s.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const u=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&a(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},l=t=>{const e=(t=>u()?.emulatorHosts?.[t])(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},h=()=>u()?.config;class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function f(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function p(t){return(await fetch(t,{credentials:"include"})).ok}function m(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(i)),""].join(".")}const g={};let y=!1;function w(t,e){if("undefined"==typeof window||"undefined"==typeof document||!f(window.location.host)||g[t]===e||g[t]||y)return;function n(t){return`__firebase__banner__${t}`}g[t]=e;const r="__firebase__banner",s=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(g))g[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function i(){const t=function(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}(r),e=n("text"),i=document.getElementById(e)||document.createElement("span"),o=n("learnmore"),a=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;!function(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}(e),function(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}(a,o);const n=function(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{y=!0,function(){const t=document.getElementById(r);t&&t.remove()}()},t}();!function(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}(u,c),e.append(u,i,a,n),document.body.appendChild(e)}s?(i.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function b(){const t=u()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function E(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function T(){return!b()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){return!b()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function S(){try{return"object"==typeof indexedDB}catch(t){return!1}}function C(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}function I(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class A extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,A.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,s=this.errors[t],i=s?function(t,e){return t.replace(N,(t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`})}(s,n):"Error",o=`${this.serviceName}: ${i} (${r}).`;return new A(r,o,n)}}const N=/\{\$([^}]+)}/g;function k(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const n=t[s],i=e[s];if(R(n)&&R(i)){if(!k(n,i))return!1}else if(n!==i)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function R(t){return null!==t&&"object"==typeof t}const O=1e3,x=2,L=144e5,M=.5;function P(t,e=O,n=x){const r=e*Math.pow(n,t),s=Math.round(M*r*(Math.random()-.5)*2);return Math.min(L,r+s)}function F(t){return t&&t._delegate?t._delegate:t}},333:(t,e,n)=>{n.d(e,{KO:()=>J,MF:()=>Q,Sx:()=>X,Wp:()=>W,j6:()=>z,om:()=>$,xZ:()=>K});var r=n(873),s=n(812),i=n(99),o=n(674);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===e?.type}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null}).filter(t=>t).join(" ")}}const c="@firebase/app",u="0.14.2",l=new s.Vy("@firebase/app"),h="@firebase/app-compat",d="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",m="@firebase/app-check",g="@firebase/auth",y="@firebase/auth-compat",w="@firebase/database",v="@firebase/data-connect",b="@firebase/database-compat",E="@firebase/functions",T="@firebase/functions-compat",_="@firebase/installations",S="@firebase/installations-compat",C="@firebase/messaging",I="@firebase/messaging-compat",A="@firebase/performance",D="@firebase/performance-compat",N="@firebase/remote-config",k="@firebase/remote-config-compat",R="@firebase/storage",O="@firebase/storage-compat",x="@firebase/firestore",L="@firebase/ai",M="@firebase/firestore-compat",P="firebase",F="[DEFAULT]",V={[c]:"fire-core",[h]:"fire-core-compat",[f]:"fire-analytics",[d]:"fire-analytics-compat",[m]:"fire-app-check",[p]:"fire-app-check-compat",[g]:"fire-auth",[y]:"fire-auth-compat",[w]:"fire-rtdb",[v]:"fire-data-connect",[b]:"fire-rtdb-compat",[E]:"fire-fn",[T]:"fire-fn-compat",[_]:"fire-iid",[S]:"fire-iid-compat",[C]:"fire-fcm",[I]:"fire-fcm-compat",[A]:"fire-perf",[D]:"fire-perf-compat",[N]:"fire-rc",[k]:"fire-rc-compat",[R]:"fire-gcs",[O]:"fire-gcs-compat",[x]:"fire-fst",[M]:"fire-fst-compat",[L]:"fire-vertex","fire-js":"fire-js",[P]:"fire-js-all"},U=new Map,j=new Map,B=new Map;function q(t,e){try{t.container.addComponent(e)}catch(n){l.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $(t){const e=t.name;if(B.has(e))return l.debug(`There were multiple attempts to register component ${e}.`),!1;B.set(e,t);for(const e of U.values())q(e,t);for(const e of j.values())q(e,t);return!0}function z(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function K(t){return null!=t&&void 0!==t.settings}const G=new i.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class H{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw G.create("app-deleted",{appName:this._name})}}const Q="12.2.0";function W(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const s={name:F,automaticDataCollectionEnabled:!0,...e},o=s.name;if("string"!=typeof o||!o)throw G.create("bad-app-name",{appName:String(o)});if(n||(n=(0,i.T9)()),!n)throw G.create("no-options");const a=U.get(o);if(a){if((0,i.bD)(n,a.options)&&(0,i.bD)(s,a.config))return a;throw G.create("duplicate-app",{appName:o})}const c=new r.h1(o);for(const t of B.values())c.addComponent(t);const u=new H(n,s,c);return U.set(o,u),u}function X(t=F){const e=U.get(t);if(!e&&t===F&&(0,i.T9)())return W();if(!e)throw G.create("no-app",{appName:t});return e}function J(t,e,n){let s=V[t]??t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const t=[`Unable to register library "${s}" with version "${e}":`];return i&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void l.warn(t.join(" "))}$(new r.uA(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const Y="firebase-heartbeat-store";let Z=null;function tt(){return Z||(Z=(0,o.P2)("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Y)}catch(t){console.warn(t)}}}).catch(t=>{throw G.create("idb-open",{originalErrorMessage:t.message})})),Z}async function et(t,e){try{const n=(await tt()).transaction(Y,"readwrite"),r=n.objectStore(Y);await r.put(e,nt(t)),await n.done}catch(t){if(t instanceof i.g)l.warn(t.message);else{const e=G.create("idb-set",{originalErrorMessage:t?.message});l.warn(e.message)}}}function nt(t){return`${t.name}!${t.options.appId}`}class rt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new it(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=st();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===e||this._heartbeatsCache.heartbeats.some(t=>t.date===e))return;if(this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){l.warn(t)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const t=st(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let r=t.slice();for(const s of t){const t=n.find(t=>t.agent===s.agent);if(t){if(t.dates.push(s.date),ot(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ot(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,i.Uj)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return l.warn(t),""}}}function st(){return(new Date).toISOString().substring(0,10)}class it{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await tt()).transaction(Y),n=await e.objectStore(Y).get(nt(t));return await e.done,n}catch(t){if(t instanceof i.g)l.warn(t.message);else{const e=G.create("idb-get",{originalErrorMessage:t?.message});l.warn(e.message)}}}(this.app);return t?.heartbeats?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const e=await this.read();return et(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??e.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){if(await this._canUseIndexedDBPromise){const e=await this.read();return et(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??e.lastSentHeartbeatDate,heartbeats:[...e.heartbeats,...t.heartbeats]})}}}function ot(t){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:t})).length}$(new r.uA("platform-logger",t=>new a(t),"PRIVATE")),$(new r.uA("heartbeat",t=>new rt(t),"PRIVATE")),J(c,u,""),J(c,u,"esm2020"),J("fire-js","")},334:(t,e,n)=>{n.a(t,async(t,e)=>{try{var r=n(917),s=n(913),i=n(728),o=n(347);const a=new kakao.maps.LatLng(37.400555,127.111465),c=new kakao.maps.Map(document.querySelector("#map"),{center:a}),u=new kakao.maps.LatLngBounds;u.extend(a),c.setBounds(u),new kakao.maps.Marker({position:a}).setMap(c),c.addControl(new kakao.maps.ZoomControl,kakao.maps.ControlPosition.RIGHT),document.querySelectorAll(".account").forEach(t=>{t.addEventListener("click",()=>{const e={groom:"박주빈 ㅇㅇ은행 00000000000000",groomFather:"박종국 ㅇㅇ은행 00000000000000",groomMother:"한성숙 ㅇㅇ은행 00000000000000",bride:"이승후 ㅇㅇ은행 00000000000000",brideFather:"성이름 ㅇㅇ은행 00000000000000",brideMother:"성이름 ㅇㅇ은행 00000000000000"}[t.id];navigator.clipboard.writeText(e).then(()=>{alert("계좌번호를 복사했습니다.\n"+e)},()=>{alert("계좌번호를 복사하지 못했습니다.\n"+e)})})}),Kakao.init("ea34a43f1bb28341f65031b415ac9f58"),document.querySelector("#share").addEventListener("click",()=>{Kakao.Share.sendCustom({templateId:87412})});const l=(0,s.Wp)((await r.A.get("https://tokens.yehwan.kim/tokens")).data.firebase),h=((0,i.P5)(l),(0,o.aU)(l)),d=(0,o.rJ)(h,"messages");function f(){const t=document.querySelector("#messages");t.innerHTML="",(0,o.GG)((0,o.P)(d,(0,o.My)("timestamp","desc"))).then(e=>{e.forEach(e=>{const n=e.data(),r=document.createElement("span");r.appendChild(document.createTextNode(n.name));const s=document.createElement("span");s.appendChild(document.createTextNode("x"));const i=document.createElement("div");i.className="w-6 c-gray c-p",i.appendChild(s),i.addEventListener("click",()=>{prompt("비밀번호를 입력하세요.","").trim()===n.password?(0,o.kd)((0,o.H9)(d,e.id)).then(()=>{alert("메시지를 삭제했습니다."),f()},()=>{alert("메시지를 삭제하지 못했습니다.")}).catch(()=>{alert("메시지를 삭제하지 못했습니다.")}):alert("비밀번호가 틀렸습니다.")});const a=document.createElement("div");a.className="w-60 fd-r jc-sb",a.appendChild(r),a.appendChild(i);const c=document.createElement("span");c.appendChild(document.createTextNode(n.message));const u=document.createElement("div");u.className="mt-5 fs-3",u.appendChild(c);const l=document.createElement("div");l.className="mt-10 w-60 ai-fs",l.appendChild(a),l.appendChild(u),t.appendChild(l)})},()=>{alert("메시지를 불러오지 못했습니다.")}).catch(()=>{alert("메시지를 불러오지 못했습니다.")})}document.querySelector("form").addEventListener("submit",t=>{t.preventDefault(),(0,o.gS)(d,{name:document.querySelector("#name").value.trim(),message:document.querySelector("#message").value.trim(),password:document.querySelector("#password").value.trim(),timestamp:(0,o.O5)()}).then(()=>{alert("메시지를 등록했습니다."),f()},()=>{alert("메시지를 등록하지 못했습니다.")}).catch(()=>{alert("메시지를 등록하지 못했습니다.")})}),f(),e()}catch(p){e(p)}},1)},347:(t,e,n)=>{n.d(e,{gS:()=>hc,rJ:()=>fa,kd:()=>lc,H9:()=>pa,GG:()=>uc,aU:()=>va,My:()=>Ya,P:()=>Qa,O5:()=>fc});var r,s,i=n(333),o=n(873),a=n(812),c=n(99),u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],o=e+(i^n&(s^i))+r[0]+3614090360&4294967295;o=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=(n=(s=(i=(e=n+(o<<7&4294967295|o>>>25))+((o=i+(s^e&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(i^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^n&(s^i))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^e&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(i^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^n&(s^i))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^e&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(i^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^n&(s^i))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^e&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(i^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^i&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(i^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(s^i))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^i&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(i^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(s^i))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^i&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(i^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(s^i))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^i&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(i^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(s^i))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^s^i)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^i)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^i)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^i)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(s^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~s))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(s|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(s^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~s))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(s|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(s^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~s))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(s|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(e=n+((o=e+(s^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~s))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((s=i+((o=s+(e^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}function i(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=0|t[s];r&&i==e||(n[s]=i,r=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return e.prototype[n].apply(t,s)}}(e,function(){this.blockSize=-1}),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var r=e-this.blockSize,s=this.B,i=this.h,o=0;o<e;){if(0==i)for(;o<=r;)n(this,t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(s[i++]=t.charCodeAt(o++),i==this.blockSize){n(this,s),i=0;break}}else for(;o<e;)if(s[i++]=t[o++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var o={};function a(t){return-128<=t&&128>t?function(t){var e=o;return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=function(t){return new i([0|t],0>t?-1:0)}(t)}(t):new i([0|t],0>t?-1:0)}function c(t){if(isNaN(t)||!isFinite(t))return u;if(0>t)return m(c(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=4294967296;return new i(e,0)}var u=a(0),h=a(1),d=a(16777216);function f(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function p(t){return-1==t.h}function m(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new i(n,~t.h).add(h)}function g(t,e){return t.add(m(e))}function y(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function w(t,e){this.g=t,this.h=e}function v(t,e){if(f(e))throw Error("division by zero");if(f(t))return new w(u,u);if(p(t))return e=v(m(t),e),new w(m(e.g),m(e.h));if(p(e))return e=v(t,m(e)),new w(m(e.g),e.h);if(30<t.g.length){if(p(t)||p(e))throw Error("slowDivide_ only works with positive integers.");for(var n=h,r=e;0>=r.l(t);)n=b(n),r=b(r);var s=E(n,1),i=E(r,1);for(r=E(r,2),n=E(n,2);!f(r);){var o=i.add(r);0>=o.l(t)&&(s=s.add(n),i=o),r=E(r,1),n=E(n,1)}return e=g(t,s.j(e)),new w(s,e)}for(s=u;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(i=c(n)).j(e);p(o)||0<o.l(t);)o=(i=c(n-=r)).j(e);f(i)&&(i=h),s=s.add(i),t=g(t,o)}return new w(s,t)}function b(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.i(r)<<1|t.i(r-1)>>>31;return new i(n,t.h)}function E(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],o=0;o<r;o++)s[o]=0<e?t.i(o+n)>>>e|t.i(o+n+1)<<32-e:t.i(o+n);return new i(s,t.h)}(t=i.prototype).m=function(){if(p(this))return-m(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.i(n);t+=(0<=r?r:4294967296+r)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(f(this))return"0";if(p(this))return"-"+m(this).toString(t);for(var e=c(Math.pow(t,6)),n=this,r="";;){var s=v(n,e).g,i=((0<(n=g(n,s.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(f(n=s))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return p(t=g(this,t))?-1:f(t)?0:1},t.abs=function(){return p(this)?m(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var o=r+(65535&this.i(s))+(65535&t.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(t.i(s)>>>16);r=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new i(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(f(this)||f(t))return u;if(p(this))return p(t)?m(this).j(m(t)):m(m(this).j(t));if(p(t))return m(this.j(m(t)));if(0>this.l(d)&&0>t.l(d))return c(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var o=this.i(r)>>>16,a=65535&this.i(r),l=t.i(s)>>>16,h=65535&t.i(s);n[2*r+2*s]+=a*h,y(n,2*r+2*s),n[2*r+2*s+1]+=o*h,y(n,2*r+2*s+1),n[2*r+2*s+1]+=a*l,y(n,2*r+2*s+1),n[2*r+2*s+2]+=o*l,y(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new i(n,0)},t.A=function(t){return v(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.i(r)&t.i(r);return new i(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.i(r)|t.i(r);return new i(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.i(r)^t.i(r);return new i(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,s=l.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return m(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=c(Math.pow(n,8)),s=u,i=0;i<e.length;i+=8){var o=Math.min(8,e.length-i),a=parseInt(e.substring(i,i+o),n);8>o?(o=c(Math.pow(n,o)),s=s.j(o).add(c(a))):s=(s=s.j(r)).add(c(a))}return s},r=l.Integer=i}).apply(void 0!==u?u:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var h,d,f,p,m,g,y,w,v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t},n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof v&&v];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,r){if(r)t:{var s=n;t=t.split(".");for(var i=0;i<t.length-1;i++){var o=t[i];if(!(o in s))break t;s=s[o]}(r=r(i=s[t=t[t.length-1]]))!=i&&null!=r&&e(s,t,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,s={next:function(){if(!r&&n<t.length){var s=n++;return{value:e(0,t[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,function(t,e){return e})}});var r=r||{},s=this||self;function i(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function o(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function a(t,e,n){return t.call.apply(t.bind,arguments)}function c(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function u(t,e,n){return(u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:c).apply(null,arguments)}function l(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return e.prototype[n].apply(t,s)}}function T(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function _(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(i(n)){const e=t.length||0,r=n.length||0;t.length=e+r;for(let s=0;s<r;s++)t[e+s]=n[s]}else t.push(n)}}function S(t){return/^[\s\xa0]*$/.test(t)}function C(){var t=s.navigator;return t&&(t=t.userAgent)?t:""}function I(t){return I[" "](t),t}I[" "]=function(){};var A=!(-1==C().indexOf("Gecko")||-1!=C().toLowerCase().indexOf("webkit")&&-1==C().indexOf("Edge")||-1!=C().indexOf("Trident")||-1!=C().indexOf("MSIE")||-1!=C().indexOf("Edge"));function D(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function N(t){const e={};for(const n in t)e[n]=t[n];return e}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(t,e){let n,r;for(let e=1;e<arguments.length;e++){for(n in r=arguments[e],r)t[n]=r[n];for(let e=0;e<k.length;e++)n=k[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function O(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function x(t){s.setTimeout(()=>{throw t},0)}function L(){var t=U;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var M=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new P,t=>t.reset());class P{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let F,V=!1,U=new class{constructor(){this.h=this.g=null}add(t,e){const n=M.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},j=()=>{const t=s.Promise.resolve(void 0);F=()=>{t.then(B)}};var B=()=>{for(var t;t=L();){try{t.h.call(t.g)}catch(t){x(t)}var e=M;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}V=!1};function q(){this.s=this.s,this.C=this.C}function $(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},$.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};s.addEventListener("test",t,e),s.removeEventListener("test",t,e)}catch(t){}return t}();function K(t,e){if($.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(A){t:{try{I(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:G[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&K.aa.h.call(this)}}E(K,$);var G={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var H="closure_listenable_"+(1e6*Math.random()|0),Q=0;function W(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=s,this.key=++Q,this.da=this.fa=!1}function X(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function J(t){this.src=t,this.g={},this.h=0}function Y(t,e){var n=e.type;if(n in t.g){var r,s=t.g[n],i=Array.prototype.indexOf.call(s,e,void 0);(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(X(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Z(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.da&&i.listener==e&&i.capture==!!n&&i.ha==r)return s}return-1}J.prototype.add=function(t,e,n,r,s){var i=t.toString();(t=this.g[i])||(t=this.g[i]=[],this.h++);var o=Z(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new W(e,this.src,i,!!r,s)).fa=n,t.push(e)),e};var tt="closure_lm_"+(1e6*Math.random()|0),et={};function nt(t,e,n,r,s){if(r&&r.once)return st(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)nt(t,e[i],n,r,s);return null}return n=ht(n),t&&t[H]?t.K(e,n,o(r)?!!r.capture:!!r,s):rt(t,e,n,!1,r,s)}function rt(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var a=o(s)?!!s.capture:!!s,c=ut(t);if(c||(t[tt]=c=new J(t)),(n=c.add(e,n,r,a,i)).proxy)return n;if(r=function(){const t=ct;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)z||(s=a),void 0===s&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(at(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function st(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)st(t,e[i],n,r,s);return null}return n=ht(n),t&&t[H]?t.L(e,n,o(r)?!!r.capture:!!r,s):rt(t,e,n,!0,r,s)}function it(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)it(t,e[i],n,r,s);else r=o(r)?!!r.capture:!!r,n=ht(n),t&&t[H]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Z(i=t.g[e],n,r,s))&&(X(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete t.g[e],t.h--))):t&&(t=ut(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Z(e,n,r,s)),(n=-1<t?e[t]:null)&&ot(n))}function ot(t){if("number"!=typeof t&&t&&!t.da){var e=t.src;if(e&&e[H])Y(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(at(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ut(e))?(Y(n,t),0==n.h&&(n.src=null,e[tt]=null)):X(t)}}}function at(t){return t in et?et[t]:et[t]="on"+t}function ct(t,e){if(t.da)t=!0;else{e=new K(e,this);var n=t.listener,r=t.ha||t.src;t.fa&&ot(t),t=n.call(r,e)}return t}function ut(t){return(t=t[tt])instanceof J?t:null}var lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function ht(t){return"function"==typeof t?t:(t[lt]||(t[lt]=function(e){return t.handleEvent(e)}),t[lt])}function dt(){q.call(this),this.i=new J(this),this.M=this,this.F=null}function ft(t,e){var n,r=t.F;if(r)for(n=[];r;r=r.F)n.push(r);if(t=t.M,r=e.type||e,"string"==typeof e)e=new $(e,t);else if(e instanceof $)e.target=e.target||t;else{var s=e;R(e=new $(r,t),s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=pt(o,r,!0,e)&&s}if(s=pt(o=e.g=t,r,!0,e)&&s,s=pt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=pt(o=e.g=n[i],r,!1,e)&&s}function pt(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.da&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.fa&&Y(t.i,o),s=!1!==a.call(c,r)&&s}}return s&&!r.defaultPrevented}function mt(t,e,n){if("function"==typeof t)n&&(t=u(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=u(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function gt(t){t.g=mt(()=>{t.g=null,t.i&&(t.i=!1,gt(t))},t.l);const e=t.h;t.h=null,t.m.apply(null,e)}E(dt,q),dt.prototype[H]=!0,dt.prototype.removeEventListener=function(t,e,n,r){it(this,t,e,n,r)},dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)X(n[r]);delete e.g[t],e.h--}}this.F=null},dt.prototype.K=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},dt.prototype.L=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};class yt extends q{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:gt(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wt(t){q.call(this),this.h=t,this.g={}}E(wt,q);var vt=[];function bt(t){D(t.g,function(t,e){this.g.hasOwnProperty(e)&&ot(t)},t),t.g={}}wt.prototype.N=function(){wt.aa.N.call(this),bt(this)},wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Et=s.JSON.stringify,Tt=s.JSON.parse,_t=class{stringify(t){return s.JSON.stringify(t,void 0)}parse(t){return s.JSON.parse(t,void 0)}};function St(){}function Ct(t){return t.h||(t.h=t.i())}function It(){}St.prototype.h=null;var At={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dt(){$.call(this,"d")}function Nt(){$.call(this,"c")}E(Dt,$),E(Nt,$);var kt={},Rt=null;function Ot(){return Rt=Rt||new dt}function xt(t){$.call(this,kt.La,t)}function Lt(t){const e=Ot();ft(e,new xt(e))}function Mt(t,e){$.call(this,kt.STAT_EVENT,t),this.stat=e}function Pt(t){const e=Ot();ft(e,new Mt(e,t))}function Ft(t,e){$.call(this,kt.Ma,t),this.size=e}function Vt(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},e)}function Ut(){this.g=!0}function jt(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return Et(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}kt.La="serverreachability",E(xt,$),kt.STAT_EVENT="statevent",E(Mt,$),kt.Ma="timingevent",E(Ft,$),Ut.prototype.xa=function(){this.g=!1},Ut.prototype.info=function(){};var Bt,qt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$t={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function zt(){}function Kt(t,e,n,r){this.j=t,this.i=e,this.l=n,this.R=r||1,this.U=new wt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gt}function Gt(){this.i=null,this.g="",this.h=!1}E(zt,St),zt.prototype.g=function(){return new XMLHttpRequest},zt.prototype.i=function(){return{}},Bt=new zt;var Ht={},Qt={};function Wt(t,e,n){t.L=1,t.v=Ee(ge(e)),t.m=n,t.P=!0,Xt(t,null)}function Xt(t,e){t.F=Date.now(),Zt(t),t.A=ge(t.v);var n=t.A,r=t.R;Array.isArray(r)||(r=[String(r)]),Me(n.i,"t",r),t.C=0,n=t.j.J,t.h=new Gt,t.g=_n(t.j,n?e:null,!t.m),0<t.O&&(t.M=new yt(u(t.Y,t,t.g),t.O)),e=t.U,n=t.g,r=t.ca;var s="readystatechange";Array.isArray(s)||(s&&(vt[0]=s.toString()),s=vt);for(var i=0;i<s.length;i++){var o=nt(n,s[i],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}e=t.H?N(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Lt(),function(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+"\n"+n+"\n"+o})}(t.i,t.u,t.A,t.l,t.R,t.m)}function Jt(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.j.Ca}function Yt(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Qt:(n=Number(e.substring(n,r)),isNaN(n)?Ht:(r+=1)+n>e.length?Qt:(e=e.slice(r,r+n),t.C=r+n,e))}function Zt(t){t.S=Date.now()+t.I,te(t,t.I)}function te(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Vt(u(t.ba,t),e)}function ee(t){t.B&&(s.clearTimeout(t.B),t.B=null)}function ne(t){0==t.j.G||t.J||wn(t.j,t)}function re(t){ee(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,bt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function se(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||ue(n.h,t)))if(!t.K&&ue(n.h,t)&&3==n.G){try{var r=n.Da.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;yn(n),an(n)}pn(n),Pt(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=Vt(u(n.Za,n),6e3));if(1>=ce(n.h)&&n.ca){try{n.ca()}catch(t){}n.ca=void 0}}else bn(n,11)}else if((t.K||n.g==t)&&yn(n),!S(e))for(s=n.Da.g.parse(e),e=0;e<s.length;e++){let u=s[e];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.K=u[1],n.ia=u[2];const e=u[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const s=u[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var i=r.h;i.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(le(i,i.h),i.h=null))}if(r.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.ya=t,be(r.I,r.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=t;if((r=n).qa=Tn(r,r.J?r.ia:null,r.W),o.K){he(r.h,o);var a=o,c=r.L;c&&(a.I=c),a.B&&(ee(a),Zt(a)),r.g=o}else fn(r);0<n.i.length&&un(n)}else"stop"!=u[0]&&"close"!=u[0]||bn(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?bn(n,7):on(n):"noop"!=u[0]&&n.l&&n.l.ta(u),n.v=0)}Lt()}catch(t){}}Kt.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==en(t)?e.j():this.Y(t)},Kt.prototype.Y=function(t){try{if(t==this.g)t:{const d=en(this.g);var e=this.g.Ba();if(this.g.Z(),!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=d||7==e||Lt(),ee(this);var n=this.g.Z();this.X=n;e:if(Jt(this)){var r=nn(this.g);t="";var i=r.length,o=4==en(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){re(this),ne(this);var a="";break e}this.h.i=new s.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:!(o&&e==i-1)});r.length=0,this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+i+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){e:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(c)){var l=c;break e}}l=null}if(!(n=l)){this.o=!1,this.s=3,Pt(12),re(this),ne(this);break t}jt(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,se(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<a.length;){if(t=Yt(this,a),t==Qt){4==d&&(this.s=4,Pt(14),n=!1),jt(this.i,this.l,null,"[Incomplete Response]");break}if(t==Ht){this.s=4,Pt(15),jt(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}jt(this.i,this.l,t,null),se(this,t)}if(Jt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Pt(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),mn(h),h.M=!0,Pt(11))}}else jt(this.i,this.l,a,"[Invalid Chunked Response]"),re(this),ne(this)}else jt(this.i,this.l,a,null),se(this,a);4==d&&re(this),this.o&&!this.J&&(4==d?wn(this.j,this):(this.o=!1,Zt(this)))}else(function(t){const e={};t=(t.g&&2<=en(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(S(t[r]))continue;var n=O(t[r]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(t){return t.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Pt(12)):(this.s=0,Pt(13)),re(this),ne(this)}}}catch(t){}},Kt.prototype.cancel=function(){this.J=!0,re(this)},Kt.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.i,this.A),2!=this.L&&(Lt(),Pt(17)),re(this),this.s=2,ne(this)):te(this,this.S-t)};var ie=class{constructor(t,e){this.g=t,this.map=e}};function oe(t){this.l=t||10,t=s.PerformanceNavigationTiming?0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ae(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ce(t){return t.h?1:t.g?t.g.size:0}function ue(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function le(t,e){t.g?t.g.add(e):t.h=e}function he(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function de(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return T(t.i)}function fe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(i(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(i(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(i(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),s=r.length,o=0;o<s;o++)e.call(void 0,r[o],n&&n[o],t)}oe.prototype.cancel=function(){if(this.i=de(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function me(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof me){this.h=t.h,ye(this,t.j),this.o=t.o,this.g=t.g,we(this,t.s),this.l=t.l;var e=t.i,n=new Re;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),ve(this,n),this.m=t.m}else t&&(e=String(t).match(pe))?(this.h=!1,ye(this,e[1]||"",!0),this.o=Te(e[2]||""),this.g=Te(e[3]||"",!0),we(this,e[4]),this.l=Te(e[5]||"",!0),ve(this,e[6]||"",!0),this.m=Te(e[7]||"")):(this.h=!1,this.i=new Re(null,this.h))}function ge(t){return new me(t)}function ye(t,e,n){t.j=n?Te(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function we(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function ve(t,e,n){e instanceof Re?(t.i=e,function(t,e){e&&!t.j&&(Oe(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(xe(this,e),Me(this,n,t))},t)),t.j=e}(t.i,t.h)):(n||(e=_e(e,Ne)),t.i=new Re(e,t.h))}function be(t,e,n){t.i.set(e,n)}function Ee(t){return be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Te(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _e(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Se),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Se(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}me.prototype.toString=function(){var t=[],e=this.j;e&&t.push(_e(e,Ie,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(_e(e,Ie,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(_e(n,"/"==n.charAt(0)?De:Ae,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",_e(n,ke)),t.join("")};var Ce,Ie=/[#\/\?@]/g,Ae=/[#\?:]/g,De=/[#\?]/g,Ne=/[#\?@]/g,ke=/#/g;function Re(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Oe(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function xe(t,e){Oe(t),e=Pe(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Le(t,e){return Oe(t),e=Pe(t,e),t.g.has(e)}function Me(t,e,n){xe(t,e),0<n.length&&(t.i=null,t.g.set(Pe(t,e),T(n)),t.h+=n.length)}function Pe(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Fe(t,e,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(t){}}function Ve(){this.g=new _t}function Ue(t,e,n){const r=n||"";try{fe(t,function(t,n){let s=t;o(t)&&(s=Et(t)),e.push(r+n+"="+encodeURIComponent(s))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function je(t){this.l=t.Ub||null,this.j=t.eb||!1}function Be(t,e){dt.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function qe(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function $e(t){t.readyState=4,t.l=null,t.j=null,t.v=null,ze(t)}function ze(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ke(t){let e="";return D(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function Ge(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Ke(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):be(t,e,n))}function He(t){dt.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=Re.prototype).add=function(t,e){Oe(this),this.i=null,t=Pe(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){Oe(this),this.g.forEach(function(n,r){n.forEach(function(n){t.call(e,n,r,this)},this)},this)},t.na=function(){Oe(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let t=0;t<s.length;t++)n.push(e[r])}return n},t.V=function(t){Oe(this);let e=[];if("string"==typeof t)Le(this,t)&&(e=e.concat(this.g.get(Pe(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return Oe(this),this.i=null,Le(this,t=Pe(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")},E(je,St),je.prototype.g=function(){return new Be(this.l,this.j)},je.prototype.i=(Ce={},function(){return Ce}),E(Be,dt),(t=Be.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,ze(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||s).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$e(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ze(this)),this.g&&(this.readyState=3,ze(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==s.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qe(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?$e(this):ze(this),3==this.readyState&&qe(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,$e(this))},t.Qa=function(t){this.g&&(this.response=t,$e(this))},t.ga=function(){this.g&&$e(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Be.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),E(He,dt);var Qe=/^https?$/i,We=["POST","PUT"];function Xe(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,Je(t),Ze(t)}function Je(t){t.A||(t.A=!0,ft(t,"complete"),ft(t,"error"))}function Ye(t){if(t.h&&void 0!==r&&(!t.v[1]||4!=en(t)||2!=t.Z()))if(t.u&&4==en(t))mt(t.Ea,0,t);else if(ft(t,"readystatechange"),4==en(t)){t.h=!1;try{const r=t.Z();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===r){var o=String(t.D).match(pe)[1]||null;!o&&s.self&&s.self.location&&(o=s.self.location.protocol.slice(0,-1)),i=!Qe.test(o?o.toLowerCase():"")}n=i}if(n)ft(t,"complete"),ft(t,"success");else{t.m=6;try{var a=2<en(t)?t.g.statusText:""}catch(t){a=""}t.l=a+" ["+t.Z()+"]",Je(t)}}finally{Ze(t)}}}function Ze(t,e){if(t.g){tn(t);const n=t.g,r=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function tn(t){t.I&&(s.clearTimeout(t.I),t.I=null)}function en(t){return t.g?t.g.readyState:0}function nn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function sn(t){this.Aa=0,this.i=[],this.j=new Ut,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,t),this.cb=rn("retryDelaySeedMs",1e4,t),this.Wa=rn("forwardChannelMaxRetries",2,t),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new oe(t&&t.concurrentRequestLimit),this.Da=new Ve,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(t){if(cn(t),3==t.G){var e=t.U++,n=ge(t.I);if(be(n,"SID",t.K),be(n,"RID",e),be(n,"TYPE","terminate"),hn(t,n),(e=new Kt(t,t.j,e)).L=2,e.v=Ee(ge(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&s.Image&&((new Image).src=e.v,n=!0),n||(e.g=_n(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Zt(e)}En(t)}function an(t){t.g&&(mn(t),t.g.cancel(),t.g=null)}function cn(t){an(t),t.u&&(s.clearTimeout(t.u),t.u=null),yn(t),t.h.cancel(),t.s&&("number"==typeof t.s&&s.clearTimeout(t.s),t.s=null)}function un(t){if(!ae(t.h)&&!t.s){t.s=!0;var e=t.Ga;F||j(),V||(F(),V=!0),U.add(e,t),t.B=0}}function ln(t,e){var n;n=e?e.l:t.U++;const r=ge(t.I);be(r,"SID",t.K),be(r,"RID",n),be(r,"AID",t.T),hn(t,r),t.m&&t.o&&Ge(r,t.m,t.o),n=new Kt(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=dn(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),le(t.h,n),Wt(n,r,e)}function hn(t,e){t.H&&D(t.H,function(t,n){be(e,n,t)}),t.l&&fe({},function(t,n){be(e,n,t)})}function dn(t,e,n){n=Math.min(t.i.length,n);var r=t.l?u(t.l.Na,t.l,t):null;t:{var s=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let i=!0;for(let o=0;o<n;o++){let n=s[o].g;const a=s[o].map;if(n-=e,0>n)e=Math.max(0,s[o].g-100),i=!1;else try{Ue(a,t,"req"+n+"_")}catch(t){r&&r(a)}}if(i){r=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,r}function fn(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;F||j(),V||(F(),V=!0),U.add(e,t),t.v=0}}function pn(t){return!(t.g||t.u||3<=t.v||(t.Y++,t.u=Vt(u(t.Fa,t),vn(t,t.v)),t.v++,0))}function mn(t){null!=t.A&&(s.clearTimeout(t.A),t.A=null)}function gn(t){t.g=new Kt(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=ge(t.qa);be(e,"RID","rpc"),be(e,"SID",t.K),be(e,"AID",t.T),be(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&be(e,"TO",t.ja),be(e,"TYPE","xmlhttp"),hn(t,e),t.m&&t.o&&Ge(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=Ee(ge(e)),n.m=null,n.P=!0,Xt(n,t)}function yn(t){null!=t.C&&(s.clearTimeout(t.C),t.C=null)}function wn(t,e){var n=null;if(t.g==e){yn(t),mn(t),t.g=null;var r=2}else{if(!ue(t.h,e))return;n=e.D,he(t.h,e),r=1}if(0!=t.G)if(e.o)if(1==r){n=e.m?e.m.length:0,e=Date.now()-e.F;var s=t.B;ft(r=Ot(),new Ft(r,n)),un(t)}else fn(t);else if(3==(s=e.s)||0==s&&0<e.X||!(1==r&&function(t,e){return!(ce(t.h)>=t.h.j-(t.s?1:0)||(t.s?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa)||(t.s=Vt(u(t.Ga,t,e),vn(t,t.B)),t.B++,0)))}(t,e)||2==r&&pn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),s){case 1:bn(t,5);break;case 4:bn(t,10);break;case 3:bn(t,6);break;default:bn(t,2)}}function vn(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function bn(t,e){if(t.j.info("Error code "+e),2==e){var n=u(t.fb,t),r=t.Xa;const e=!r;r=new me(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||ye(r,"https"),Ee(r),e?function(t,e){const n=new Ut;if(s.Image){const r=new Image;r.onload=l(Fe,n,"TestLoadImage: loaded",!0,e,r),r.onerror=l(Fe,n,"TestLoadImage: error",!1,e,r),r.onabort=l(Fe,n,"TestLoadImage: abort",!1,e,r),r.ontimeout=l(Fe,n,"TestLoadImage: timeout",!1,e,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(r.toString(),n):function(t,e){new Ut;const n=new AbortController,r=setTimeout(()=>{n.abort(),Fe(0,0,!1,e)},1e4);fetch(t,{signal:n.signal}).then(t=>{clearTimeout(r),t.ok?Fe(0,0,!0,e):Fe(0,0,!1,e)}).catch(()=>{clearTimeout(r),Fe(0,0,!1,e)})}(r.toString(),n)}else Pt(2);t.G=0,t.l&&t.l.sa(e),En(t),cn(t)}function En(t){if(t.G=0,t.ka=[],t.l){const e=de(t.h);0==e.length&&0==t.i.length||(_(t.ka,e),_(t.ka,t.i),t.h.i.length=0,T(t.i),t.i.length=0),t.l.ra()}}function Tn(t,e,n){var r=n instanceof me?ge(n):new me(n);if(""!=r.g)e&&(r.g=e+"."+r.g),we(r,r.s);else{var i=s.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var o=new me(null);r&&ye(o,r),e&&(o.g=e),i&&we(o,i),n&&(o.l=n),r=o}return n=t.D,e=t.ya,n&&e&&be(r,n,e),be(r,"VER",t.la),hn(t,r),r}function _n(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new He(new je({eb:n})):new He(t.pa)).Ha(t.J),e}function Sn(){}function Cn(){}function In(t,e){dt.call(this),this.g=new sn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!S(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!S(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Nn(this)}function An(t){Dt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Dn(){Nt.call(this),this.status=1}function Nn(t){this.g=t}(t=He.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bt.g(),this.v=this.o?Ct(this.o):Ct(Bt),this.g.onreadystatechange=u(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(t){return void Xe(this,t)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),i=s.FormData&&t instanceof s.FormData,!(0<=Array.prototype.indexOf.call(We,e,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(t),this.u=!1}catch(t){Xe(this,t)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,ft(this,"complete"),ft(this,"abort"),Ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ze(this,!0)),He.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ye(this):this.bb())},t.bb=function(){Ye(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<en(this)?this.g.status:-1}catch(t){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Tt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=sn.prototype).la=8,t.G=1,t.connect=function(t,e,n,r){Pt(0),this.W=t,this.H=e||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Tn(this,null,this.W),un(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new Kt(this,this.j,t);let i=this.o;if(this.S&&(i?(i=N(i),R(i,this.S)):i=this.S),null!==this.m||this.O||(s.H=i,i=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=dn(this,s,e),be(n=ge(this.I),"RID",t),be(n,"CVER",22),this.D&&be(n,"X-HTTP-Session-Id",this.D),hn(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(Ke(i)))+"&"+e:this.m&&Ge(n,this.m,i)),le(this.h,s),this.Ua&&be(n,"TYPE","init"),this.P?(be(n,"$req",e),be(n,"SID","null"),s.T=!0,Wt(s,n,null)):Wt(s,n,e),this.G=2}}else 3==this.G&&(t?ln(this,t):0==this.i.length||ae(this.h)||ln(this))},t.Fa=function(){if(this.u=null,gn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Vt(u(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pt(10),an(this),gn(this))},t.Za=function(){null!=this.C&&(this.C=null,an(this),pn(this),Pt(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=Sn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},Cn.prototype.g=function(t,e){return new In(t,e)},E(In,dt),In.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){on(this.g)},In.prototype.o=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=Et(t),t=n);e.i.push(new ie(e.Ya++,t)),3==e.G&&un(e)},In.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,In.aa.N.call(this)},E(An,Dt),E(Dn,Nt),E(Nn,Sn),Nn.prototype.ua=function(){ft(this.g,"a")},Nn.prototype.ta=function(t){ft(this.g,new An(t))},Nn.prototype.sa=function(t){ft(this.g,new Dn)},Nn.prototype.ra=function(){ft(this.g,"b")},Cn.prototype.createWebChannel=Cn.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,w=b.createWebChannelTransport=function(){return new Cn},y=b.getStatEventTarget=function(){return Ot()},g=b.Event=kt,m=b.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qt.NO_ERROR=0,qt.TIMEOUT=8,qt.HTTP_ERROR=6,p=b.ErrorCode=qt,$t.COMPLETE="complete",f=b.EventType=$t,It.EventType=At,At.OPEN="a",At.CLOSE="b",At.ERROR="c",At.MESSAGE="d",dt.prototype.listen=dt.prototype.K,d=b.WebChannel=It,b.FetchXmlHttpFactory=je,He.prototype.listenOnce=He.prototype.L,He.prototype.getLastError=He.prototype.Ka,He.prototype.getLastErrorCode=He.prototype.Ba,He.prototype.getStatus=He.prototype.Z,He.prototype.getResponseJson=He.prototype.Oa,He.prototype.getResponseText=He.prototype.oa,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Ha,h=b.XhrIo=He}).apply(void 0!==v?v:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const E="@firebase/firestore",T="4.9.1";class _{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}_.UNAUTHENTICATED=new _(null),_.GOOGLE_CREDENTIALS=new _("google-credentials-uid"),_.FIRST_PARTY=new _("first-party-uid"),_.MOCK_USER=new _("mock-user");let S="12.2.0";const C=new a.Vy("@firebase/firestore");function I(){return C.logLevel}function A(t,...e){if(C.logLevel<=a.$b.DEBUG){const n=e.map(k);C.debug(`Firestore (${S}): ${t}`,...n)}}function D(t,...e){if(C.logLevel<=a.$b.ERROR){const n=e.map(k);C.error(`Firestore (${S}): ${t}`,...n)}}function N(t,...e){if(C.logLevel<=a.$b.WARN){const n=e.map(k);C.warn(`Firestore (${S}): ${t}`,...n)}}function k(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function R(t,e,n){let r="Unexpected state";"string"==typeof e?r=e:n=e,O(t,r,n)}function O(t,e,n){let r=`FIRESTORE (${S}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(t){r+=" CONTEXT: "+n}throw D(r),new Error(r)}function x(t,e,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,t||O(e,s,r)}function L(t,e){return t}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class P extends c.g{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class F{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class V{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class U{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(_.UNAUTHENTICATED))}shutdown(){}}class j{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class B{constructor(t){this.t=t,this.currentUser=_.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){x(void 0===this.o,42304);let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new F;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new F,t.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const e=s;t.enqueueRetryable(async()=>{await e.promise,await r(this.currentUser)})},o=t=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(t=>o(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new F)}},0),i()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(x("string"==typeof e.accessToken,31837,{l:e}),new V(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return x(null===t||"string"==typeof t,2055,{h:t}),new _(t)}}class q{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=_.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ${constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new q(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(_.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,i.xZ)(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){x(void 0===this.o,3512);const n=t=>{null!=t.error&&A("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.m;return this.m=t.token,A("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const r=t=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(t=>r(t)),setTimeout(()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?r(t):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new z(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(x("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new z(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function G(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class H{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=G(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function Q(t,e){return t<e?-1:t>e?1:0}function W(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.charAt(r),s=e.charAt(r);if(n!==s)return Y(n)===Y(s)?Q(n,s):Y(n)?1:-1}return Q(t.length,e.length)}const X=55296,J=57343;function Y(t){const e=t.charCodeAt(0);return e>=X&&e<=J}function Z(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}const tt="__name__";class et{constructor(t,e,n){void 0===e?e=0:e>t.length&&R(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&R(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===et.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof et?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=et.compareSegments(t.get(r),e.get(r));if(0!==n)return n}return Q(t.length,e.length)}static compareSegments(t,e){const n=et.isNumericId(t),r=et.isNumericId(e);return n&&!r?-1:!n&&r?1:n&&r?et.extractNumericId(t).compare(et.extractNumericId(e)):W(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return r.fromString(t.substring(4,t.length-2))}}class nt extends et{construct(t,e,n){return new nt(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new P(M.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new nt(e)}static emptyPath(){return new nt([])}}const rt=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends et{construct(t,e,n){return new st(t,e,n)}static isValidIdentifier(t){return rt.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===tt}static keyField(){return new st([tt])}static fromServerFormat(t){const e=[];let n="",r=0;const s=()=>{if(0===n.length)throw new P(M.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let i=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new P(M.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new P(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(i=!i,r++):"."!==e||i?(n+=e,r++):(s(),r++)}if(s(),i)throw new P(M.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new st(e)}static emptyPath(){return new st([])}}class it{constructor(t){this.path=t}static fromPath(t){return new it(nt.fromString(t))}static fromName(t){return new it(nt.fromString(t).popFirst(5))}static empty(){return new it(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===nt.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return nt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new it(new nt(t.slice()))}}function ot(t,e,n){if(!n)throw new P(M.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function at(t){if(!it.isDocumentKey(t))throw new P(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ct(t){if(it.isDocumentKey(t))throw new P(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ut(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function lt(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":R(12329,{type:typeof t})}function ht(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new P(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=lt(t);throw new P(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function dt(t,e){const n={typeString:t};return e&&(n.value=e),n}function ft(t,e){if(!ut(t))throw new P(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(void 0!==i&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new P(M.INVALID_ARGUMENT,n);return!0}const pt=-62135596800,mt=1e6;class gt{static now(){return gt.fromMillis(Date.now())}static fromDate(t){return gt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*mt);return new gt(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new P(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new P(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<pt)throw new P(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new P(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mt}_compareTo(t){return this.seconds===t.seconds?Q(this.nanoseconds,t.nanoseconds):Q(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(ft(t,gt._jsonSchema))return new gt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-pt;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gt._jsonSchemaVersion="firestore/timestamp/1.0",gt._jsonSchema={type:dt("string",gt._jsonSchemaVersion),seconds:dt("number"),nanoseconds:dt("number")};class yt{static fromTimestamp(t){return new yt(t)}static min(){return new yt(new gt(0,0))}static max(){return new yt(new gt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function wt(t){return new vt(t.readTime,t.key,-1)}class vt{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new vt(yt.min(),it.empty(),-1)}static max(){return new vt(yt.max(),it.empty(),-1)}}function bt(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=it.comparator(t.documentKey,e.documentKey),0!==n?n:Q(t.largestBatchId,e.largestBatchId))}const Et="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tt{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}async function _t(t){if(t.code!==M.FAILED_PRECONDITION||t.message!==Et)throw t;A("LocalStore","Unexpectedly lost primary lease")}class St{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&R(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new St((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof St?e:St.resolve(e)}catch(t){return St.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):St.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):St.reject(e)}static resolve(t){return new St((e,n)=>{e(t)})}static reject(t){return new St((e,n)=>{n(t)})}static waitFor(t){return new St((e,n)=>{let r=0,s=0,i=!1;t.forEach(t=>{++r,t.next(()=>{++s,i&&s===r&&e()},t=>n(t))}),i=!0,s===r&&e()})}static or(t){let e=St.resolve(!1);for(const n of t)e=e.next(t=>t?St.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,r)=>{n.push(e.call(this,t,r))}),this.waitFor(n)}static mapArray(t,e){return new St((n,r)=>{const s=t.length,i=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;e(t[c]).next(t=>{i[c]=t,++o,o===s&&n(i)},t=>r(t))}})}static doWhile(t,e){return new St((n,r)=>{const s=()=>{!0===t()?e().next(()=>{s()},r):n()};s()})}}function Ct(t){return"IndexedDbTransactionError"===t.name}class It{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ae(t),this.ue=t=>e.writeSequenceNumber(t))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}It.ce=-1;const At=-1;function Dt(t){return null==t}function Nt(t){return 0===t&&1/t==-1/0}function kt(t,e){let n=e;const r=t.length;for(let e=0;e<r;e++){const r=t.charAt(e);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function Rt(t){return t+""}const Ot="owner",xt="mutationQueues",Lt="mutations",Mt="documentMutations",Pt="remoteDocumentGlobal",Ft="targets",Vt="targetDocuments",Ut="targetGlobal",jt="collectionParents",Bt="clientMetadata",qt="bundles",$t="namedQueries";function zt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Kt(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gt(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ht{constructor(t,e){this.comparator=t,this.root=e||Wt.EMPTY}insert(t,e){return new Ht(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Wt.BLACK,null,null))}remove(t){return new Ht(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Wt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Qt(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Qt(this.root,t,this.comparator,!1)}getReverseIterator(){return new Qt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Qt(this.root,t,this.comparator,!0)}}class Qt{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Wt{constructor(t,e,n,r,s){this.key=t,this.value=e,this.color=null!=n?n:Wt.RED,this.left=null!=r?r:Wt.EMPTY,this.right=null!=s?s:Wt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,s){return new Wt(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const s=n(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===s?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Wt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return Wt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw R(43730,{key:this.key,value:this.value});if(this.right.isRed())throw R(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw R(27949);return t+(this.isRed()?0:1)}}Wt.EMPTY=null,Wt.RED=!0,Wt.BLACK=!1,Wt.EMPTY=new class{constructor(){this.size=0}get key(){throw R(57766)}get value(){throw R(16141)}get color(){throw R(16727)}get left(){throw R(29726)}get right(){throw R(36894)}copy(t,e,n,r,s){return this}insert(t,e,n){return new Wt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Xt{constructor(t){this.comparator=t,this.data=new Ht(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Jt(this.data.getIterator())}getIteratorFrom(t){return new Jt(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof Xt))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Xt(this.comparator);return e.data=t,e}}class Jt{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Yt{constructor(t){this.fields=t,t.sort(st.comparator)}static empty(){return new Yt([])}unionWith(t){let e=new Xt(st.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Yt(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Z(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class Zt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class te{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Zt("Invalid base64 string: "+t):t}}(t);return new te(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new te(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Q(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}te.EMPTY_BYTE_STRING=new te("");const ee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ne(t){if(x(!!t,39018),"string"==typeof t){let e=0;const n=ee.exec(t);if(x(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:re(t.seconds),nanos:re(t.nanos)}}function re(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function se(t){return"string"==typeof t?te.fromBase64String(t):te.fromUint8Array(t)}const ie="server_timestamp",oe="__type__",ae="__previous_value__",ce="__local_write_time__";function ue(t){const e=(t?.mapValue?.fields||{})[oe]?.stringValue;return e===ie}function le(t){const e=t.mapValue.fields[ae];return ue(e)?le(e):e}function he(t){const e=ne(t.mapValue.fields[ce].timestampValue);return new gt(e.seconds,e.nanos)}class de{constructor(t,e,n,r,s,i,o,a,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=u}}const fe="(default)";class pe{constructor(t,e){this.projectId=t,this.database=e||fe}static empty(){return new pe("","")}get isDefaultDatabase(){return this.database===fe}isEqual(t){return t instanceof pe&&t.projectId===this.projectId&&t.database===this.database}}const me="__type__",ge="__max__",ye={fields:{__type__:{stringValue:ge}}},we="__vector__",ve="value";function be(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ue(t)?4:Fe(t)?9007199254740991:Me(t)?10:11:R(28295,{value:t})}function Ee(t,e){if(t===e)return!0;const n=be(t);if(n!==be(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return he(t).isEqual(he(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=ne(t.timestampValue),r=ne(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return se(t.bytesValue).isEqual(se(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return re(t.geoPointValue.latitude)===re(e.geoPointValue.latitude)&&re(t.geoPointValue.longitude)===re(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return re(t.integerValue)===re(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=re(t.doubleValue),r=re(e.doubleValue);return n===r?Nt(n)===Nt(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Z(t.arrayValue.values||[],e.arrayValue.values||[],Ee);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(zt(n)!==zt(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!Ee(n[t],r[t])))return!1;return!0}(t,e);default:return R(52216,{left:t})}}function Te(t,e){return void 0!==(t.values||[]).find(t=>Ee(t,e))}function _e(t,e){if(t===e)return 0;const n=be(t),r=be(e);if(n!==r)return Q(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Q(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=re(t.integerValue||t.doubleValue),r=re(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Se(t.timestampValue,e.timestampValue);case 4:return Se(he(t),he(e));case 5:return W(t.stringValue,e.stringValue);case 6:return function(t,e){const n=se(t),r=se(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=Q(n[t],r[t]);if(0!==e)return e}return Q(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Q(re(t.latitude),re(e.latitude));return 0!==n?n:Q(re(t.longitude),re(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Ce(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=e.fields||{},s=n[ve]?.arrayValue,i=r[ve]?.arrayValue,o=Q(s?.values?.length||0,i?.values?.length||0);return 0!==o?o:Ce(s,i)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===ye&&e===ye)return 0;if(t===ye)return 1;if(e===ye)return-1;const n=t.fields||{},r=Object.keys(n),s=e.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let t=0;t<r.length&&t<i.length;++t){const e=W(r[t],i[t]);if(0!==e)return e;const o=_e(n[r[t]],s[i[t]]);if(0!==o)return o}return Q(r.length,i.length)}(t.mapValue,e.mapValue);default:throw R(23264,{he:n})}}function Se(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Q(t,e);const n=ne(t),r=ne(e),s=Q(n.seconds,r.seconds);return 0!==s?s:Q(n.nanos,r.nanos)}function Ce(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=_e(n[t],r[t]);if(e)return e}return Q(n.length,r.length)}function Ie(t){return Ae(t)}function Ae(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=ne(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return se(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return it.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=Ae(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const s of e)r?r=!1:n+=",",n+=`${s}:${Ae(t.fields[s])}`;return n+"}"}(t.mapValue):R(61005,{value:t})}function De(t){switch(be(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=le(t);return e?16+De(e):16;case 5:return 2*t.stringValue.length;case 6:return se(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce((t,e)=>t+De(e),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return Kt(t.fields,(t,n)=>{e+=t.length+De(n)}),e}(t.mapValue);default:throw R(13486,{value:t})}}function Ne(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ke(t){return!!t&&"integerValue"in t}function Re(t){return!!t&&"arrayValue"in t}function Oe(t){return!!t&&"nullValue"in t}function xe(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Le(t){return!!t&&"mapValue"in t}function Me(t){const e=(t?.mapValue?.fields||{})[me]?.stringValue;return e===we}function Pe(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Kt(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Pe(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Pe(t.arrayValue.values[n]);return e}return{...t}}function Fe(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===ge}class Ve{constructor(t){this.value=t}static empty(){return new Ve({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Le(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Pe(e)}setAll(t){let e=st.emptyPath(),n={},r=[];t.forEach((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=s.popLast()}t?n[s.lastSegment()]=Pe(t):r.push(s.lastSegment())});const s=this.getFieldsMap(e);this.applyChanges(s,n,r)}delete(t){const e=this.field(t.popLast());Le(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ee(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];Le(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){Kt(e,(e,n)=>t[e]=n);for(const e of n)delete t[e]}clone(){return new Ve(Pe(this.value))}}function Ue(t){const e=[];return Kt(t.fields,(t,n)=>{const r=new st([t]);if(Le(n)){const t=Ue(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)}),new Yt(e)}class je{constructor(t,e,n,r,s,i,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new je(t,0,yt.min(),yt.min(),yt.min(),Ve.empty(),0)}static newFoundDocument(t,e,n,r){return new je(t,1,e,yt.min(),n,r,0)}static newNoDocument(t,e){return new je(t,2,e,yt.min(),yt.min(),Ve.empty(),0)}static newUnknownDocument(t,e){return new je(t,3,e,yt.min(),yt.min(),Ve.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(yt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ve.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ve.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof je&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new je(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Be{constructor(t,e){this.position=t,this.inclusive=e}}function qe(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(r=i.field.isKeyField()?it.comparator(it.fromName(o.referenceValue),n.key):_e(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function $e(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ee(t.position[n],e.position[n]))return!1;return!0}class ze{constructor(t,e="asc"){this.field=t,this.dir=e}}function Ke(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Ge{}class He extends Ge{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new tn(t,e,n):"array-contains"===e?new sn(t,n):"in"===e?new on(t,n):"not-in"===e?new an(t,n):"array-contains-any"===e?new cn(t,n):new He(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new en(t,n):new nn(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(_e(e,this.value)):null!==e&&be(this.value)===be(e)&&this.matchesComparison(_e(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return R(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qe extends Ge{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Qe(t,e)}matches(t){return We(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function We(t){return"and"===t.op}function Xe(t){return function(t){for(const e of t.filters)if(e instanceof Qe)return!1;return!0}(t)&&We(t)}function Je(t){if(t instanceof He)return t.field.canonicalString()+t.op.toString()+Ie(t.value);if(Xe(t))return t.filters.map(t=>Je(t)).join(",");{const e=t.filters.map(t=>Je(t)).join(",");return`${t.op}(${e})`}}function Ye(t,e){return t instanceof He?function(t,e){return e instanceof He&&t.op===e.op&&t.field.isEqual(e.field)&&Ee(t.value,e.value)}(t,e):t instanceof Qe?function(t,e){return e instanceof Qe&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,r)=>t&&Ye(n,e.filters[r]),!0)}(t,e):void R(19439)}function Ze(t){return t instanceof He?function(t){return`${t.field.canonicalString()} ${t.op} ${Ie(t.value)}`}(t):t instanceof Qe?function(t){return t.op.toString()+" {"+t.getFilters().map(Ze).join(" ,")+"}"}(t):"Filter"}class tn extends He{constructor(t,e,n){super(t,e,n),this.key=it.fromName(n.referenceValue)}matches(t){const e=it.comparator(t.key,this.key);return this.matchesComparison(e)}}class en extends He{constructor(t,e){super(t,"in",e),this.keys=rn(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class nn extends He{constructor(t,e){super(t,"not-in",e),this.keys=rn(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function rn(t,e){return(e.arrayValue?.values||[]).map(t=>it.fromName(t.referenceValue))}class sn extends He{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Re(e)&&Te(e.arrayValue,this.value)}}class on extends He{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Te(this.value.arrayValue,e)}}class an extends He{constructor(t,e){super(t,"not-in",e)}matches(t){if(Te(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!Te(this.value.arrayValue,e)}}class cn extends He{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Re(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>Te(this.value.arrayValue,t))}}class un{constructor(t,e=null,n=[],r=[],s=null,i=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=o,this.Te=null}}function ln(t,e=null,n=[],r=[],s=null,i=null,o=null){return new un(t,e,n,r,s,i,o)}function hn(t){const e=L(t);if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>Je(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>function(t){return t.field.canonicalString()+t.dir}(t)).join(","),Dt(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>Ie(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>Ie(t)).join(",")),e.Te=t}return e.Te}function dn(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ke(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ye(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$e(t.startAt,e.startAt)&&$e(t.endAt,e.endAt)}function fn(t){return it.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class pn{constructor(t,e=null,n=[],r=[],s=null,i="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function mn(t){return new pn(t)}function gn(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function yn(t){return null!==t.collectionGroup}function wn(t){const e=L(t);if(null===e.Ie){e.Ie=[];const t=new Set;for(const n of e.explicitOrderBy)e.Ie.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new Xt(st.comparator);return t.filters.forEach(t=>{t.getFlattenedFilters().forEach(t=>{t.isInequality()&&(e=e.add(t.field))})}),e}(e);r.forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new ze(r,n))}),t.has(st.keyField().canonicalString())||e.Ie.push(new ze(st.keyField(),n))}return e.Ie}function vn(t){const e=L(t);return e.Ee||(e.Ee=function(t,e){if("F"===t.limitType)return ln(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(t=>{const e="desc"===t.dir?"asc":"desc";return new ze(t.field,e)});const n=t.endAt?new Be(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Be(t.startAt.position,t.startAt.inclusive):null;return ln(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,wn(t))),e.Ee}function bn(t,e){const n=t.filters.concat([e]);return new pn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function En(t,e,n){return new pn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tn(t,e){return dn(vn(t),vn(e))&&t.limitType===e.limitType}function _n(t){return`${hn(vn(t))}|lt:${t.limitType}`}function Sn(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(t=>Ze(t)).join(", ")}]`),Dt(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>Ie(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>Ie(t)).join(",")),`Target(${e})`}(vn(t))}; limitType=${t.limitType})`}function Cn(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):it.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of wn(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=qe(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,wn(t),e)||t.endAt&&!function(t,e,n){const r=qe(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,wn(t),e))}(t,e)}function In(t){return(e,n)=>{let r=!1;for(const s of wn(t)){const t=An(s,e,n);if(0!==t)return t;r=r||s.field.isKeyField()}return 0}}function An(t,e,n){const r=t.field.isKeyField()?it.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),s=n.data.field(t);return null!==r&&null!==s?_e(r,s):R(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return R(19790,{direction:t.dir})}}class Dn{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,r]of n)if(this.equalsFn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Kt(this.inner,(e,n)=>{for(const[e,r]of n)t(e,r)})}isEmpty(){return Gt(this.inner)}size(){return this.innerSize}}const Nn=new Ht(it.comparator);function kn(){return Nn}const Rn=new Ht(it.comparator);function On(...t){let e=Rn;for(const n of t)e=e.insert(n.key,n);return e}function xn(t){let e=Rn;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ln(){return Pn()}function Mn(){return Pn()}function Pn(){return new Dn(t=>t.toString(),(t,e)=>t.isEqual(e))}const Fn=new Ht(it.comparator),Vn=new Xt(it.comparator);function Un(...t){let e=Vn;for(const n of t)e=e.add(n);return e}const jn=new Xt(Q);function Bn(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nt(e)?"-0":e}}function qn(t){return{integerValue:""+t}}function $n(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Nt(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?qn(e):Bn(t,e)}class zn{constructor(){this._=void 0}}function Kn(t,e,n){return t instanceof Qn?function(t,e){const n={fields:{[oe]:{stringValue:ie},[ce]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&ue(e)&&(e=le(e)),e&&(n.fields[ae]=e),{mapValue:n}}(n,e):t instanceof Wn?Xn(t,e):t instanceof Jn?Yn(t,e):function(t,e){const n=Hn(t,e),r=tr(n)+tr(t.Ae);return ke(n)&&ke(t.Ae)?qn(r):Bn(t.serializer,r)}(t,e)}function Gn(t,e,n){return t instanceof Wn?Xn(t,e):t instanceof Jn?Yn(t,e):n}function Hn(t,e){return t instanceof Zn?function(t){return ke(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Qn extends zn{}class Wn extends zn{constructor(t){super(),this.elements=t}}function Xn(t,e){const n=er(e);for(const e of t.elements)n.some(t=>Ee(t,e))||n.push(e);return{arrayValue:{values:n}}}class Jn extends zn{constructor(t){super(),this.elements=t}}function Yn(t,e){let n=er(e);for(const e of t.elements)n=n.filter(t=>!Ee(t,e));return{arrayValue:{values:n}}}class Zn extends zn{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function tr(t){return re(t.integerValue||t.doubleValue)}function er(t){return Re(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class nr{constructor(t,e){this.field=t,this.transform=e}}class rr{constructor(t,e){this.version=t,this.transformResults=e}}class sr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new sr}static exists(t){return new sr(void 0,t)}static updateTime(t){return new sr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ir(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class or{}function ar(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new yr(t.key,sr.none()):new dr(t.key,t.data,sr.none());{const n=t.data,r=Ve.empty();let s=new Xt(st.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),s=s.add(t)}return new fr(t.key,r,new Yt(s.toArray()),sr.none())}}function cr(t,e,n){t instanceof dr?function(t,e,n){const r=t.value.clone(),s=mr(t.fieldTransforms,e,n.transformResults);r.setAll(s),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof fr?function(t,e,n){if(!ir(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=mr(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(pr(t)),s.setAll(r),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ur(t,e,n,r){return t instanceof dr?function(t,e,n,r){if(!ir(t.precondition,e))return n;const s=t.value.clone(),i=gr(t.fieldTransforms,r,e);return s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,r):t instanceof fr?function(t,e,n,r){if(!ir(t.precondition,e))return n;const s=gr(t.fieldTransforms,r,e),i=e.data;return i.setAll(pr(t)),i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,r):function(t,e,n){return ir(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function lr(t,e){let n=null;for(const r of t.fieldTransforms){const t=e.data.field(r.field),s=Hn(r.transform,t||null);null!=s&&(null===n&&(n=Ve.empty()),n.set(r.field,s))}return n||null}function hr(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Z(t,e,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Wn&&e instanceof Wn||t instanceof Jn&&e instanceof Jn?Z(t.elements,e.elements,Ee):t instanceof Zn&&e instanceof Zn?Ee(t.Ae,e.Ae):t instanceof Qn&&e instanceof Qn}(t.transform,e.transform)}(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class dr extends or{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class fr extends or{constructor(t,e,n,r,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pr(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function mr(t,e,n){const r=new Map;x(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Gn(o,a,n[s]))}return r}function gr(t,e,n){const r=new Map;for(const s of t){const t=s.transform,i=n.data.field(s.field);r.set(s.field,Kn(t,i,e))}return r}class yr extends or{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wr extends or{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vr{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const r=this.mutations[e];r.key.isEqual(t.key)&&cr(r,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=ur(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=ur(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Mn();return this.mutations.forEach(r=>{const s=t.get(r.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=e.has(r.key)?null:o;const a=ar(i,o);null!==a&&n.set(r.key,a),i.isValidDocument()||i.convertToNoDocument(yt.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Un())}isEqual(t){return this.batchId===t.batchId&&Z(this.mutations,t.mutations,(t,e)=>hr(t,e))&&Z(this.baseMutations,t.baseMutations,(t,e)=>hr(t,e))}}class br{constructor(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}static from(t,e,n){x(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let r=Fn;const s=t.mutations;for(let t=0;t<s.length;t++)r=r.insert(s[t].key,n[t].version);return new br(t,e,n,r)}}class Er{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Tr{constructor(t,e){this.count=t,this.unchangedNames=e}}var _r,Sr;function Cr(t){if(void 0===t)return D("GRPC error has no .code"),M.UNKNOWN;switch(t){case _r.OK:return M.OK;case _r.CANCELLED:return M.CANCELLED;case _r.UNKNOWN:return M.UNKNOWN;case _r.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case _r.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case _r.INTERNAL:return M.INTERNAL;case _r.UNAVAILABLE:return M.UNAVAILABLE;case _r.UNAUTHENTICATED:return M.UNAUTHENTICATED;case _r.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case _r.NOT_FOUND:return M.NOT_FOUND;case _r.ALREADY_EXISTS:return M.ALREADY_EXISTS;case _r.PERMISSION_DENIED:return M.PERMISSION_DENIED;case _r.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case _r.ABORTED:return M.ABORTED;case _r.OUT_OF_RANGE:return M.OUT_OF_RANGE;case _r.UNIMPLEMENTED:return M.UNIMPLEMENTED;case _r.DATA_LOSS:return M.DATA_LOSS;default:return R(39323,{code:t})}}(Sr=_r||(_r={}))[Sr.OK=0]="OK",Sr[Sr.CANCELLED=1]="CANCELLED",Sr[Sr.UNKNOWN=2]="UNKNOWN",Sr[Sr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Sr[Sr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Sr[Sr.NOT_FOUND=5]="NOT_FOUND",Sr[Sr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Sr[Sr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Sr[Sr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Sr[Sr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Sr[Sr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Sr[Sr.ABORTED=10]="ABORTED",Sr[Sr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Sr[Sr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Sr[Sr.INTERNAL=13]="INTERNAL",Sr[Sr.UNAVAILABLE=14]="UNAVAILABLE",Sr[Sr.DATA_LOSS=15]="DATA_LOSS";const Ir=new r([4294967295,4294967295],0);function Ar(t){const e=(new TextEncoder).encode(t),n=new s;return n.update(e),new Uint8Array(n.digest())}function Dr(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new r([n,s],0),new r([i,o],0)]}class Nr{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new kr(`Invalid padding: ${e}`);if(n<0)throw new kr(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new kr(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new kr(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=r.fromNumber(this.ge)}ye(t,e,n){let s=t.add(e.multiply(r.fromNumber(n)));return 1===s.compare(Ir)&&(s=new r([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.ge)return!1;const e=Ar(t),[n,r]=Dr(e);for(let t=0;t<this.hashCount;t++){const e=this.ye(n,r,t);if(!this.we(e))return!1}return!0}static create(t,e,n){const r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),i=new Nr(s,r,e);return n.forEach(t=>i.insert(t)),i}insert(t){if(0===this.ge)return;const e=Ar(t),[n,r]=Dr(e);for(let t=0;t<this.hashCount;t++){const e=this.ye(n,r,t);this.Se(e)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class kr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Rr{constructor(t,e,n,r,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const r=new Map;return r.set(t,Or.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Rr(yt.min(),r,new Ht(Q),kn(),Un())}}class Or{constructor(t,e,n,r,s){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Or(n,e,Un(),Un(),Un())}}class xr{constructor(t,e,n,r){this.be=t,this.removedTargetIds=e,this.key=n,this.De=r}}class Lr{constructor(t,e){this.targetId=t,this.Ce=e}}class Mr{constructor(t,e,n=te.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class Pr{constructor(){this.ve=0,this.Fe=Ur(),this.Me=te.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Un(),e=Un(),n=Un();return this.Fe.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:R(38017,{changeType:s})}}),new Or(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=Ur()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,x(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Fr{constructor(t){this.Ge=t,this.ze=new Map,this.je=kn(),this.Je=Vr(),this.He=Vr(),this.Ye=new Ht(Q)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:R(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach((t,n)=>{this.rt(n)&&e(n)})}st(t){const e=t.targetId,n=t.Ce.count,r=this.ot(e);if(r){const s=r.target;if(fn(s))if(0===n){const t=new it(s.path);this.et(e,t,je.newNoDocument(t,yt.min()))}else x(1===n,20013,{expectedCount:n});else{const r=this._t(e);if(r!==n){const n=this.ut(t),s=n?this.ct(n,t,r):1;if(0!==s){this.it(e);const t=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,t)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=e;let i,o;try{i=se(n).toUint8Array()}catch(t){if(t instanceof Zt)return N("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new Nr(i,r,s)}catch(t){return N(t instanceof kr?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.ge?null:o}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let r=0;return n.forEach(n=>{const s=this.Ge.ht(),i=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;t.mightContain(i)||(this.et(e,n,null),r++)}),r}Tt(t){const e=new Map;this.ze.forEach((n,r)=>{const s=this.ot(r);if(s){if(n.current&&fn(s.target)){const e=new it(s.target.path);this.It(e).has(r)||this.Et(r,e)||this.et(r,e,je.newNoDocument(e,t))}n.Be&&(e.set(r,n.ke()),n.qe())}});let n=Un();this.He.forEach((t,e)=>{let r=!0;e.forEachWhile(t=>{const e=this.ot(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(r=!1,!1)}),r&&(n=n.add(t))}),this.je.forEach((e,n)=>n.setReadTime(t));const r=new Rr(t,e,this.Ye,this.je,n);return this.je=kn(),this.Je=Vr(),this.He=Vr(),this.Ye=new Ht(Q),r}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const r=this.nt(t);this.Et(t,e)?r.Qe(e,1):r.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Pr,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new Xt(Q),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new Xt(Q),this.Je=this.Je.insert(t,e)),e}rt(t){const e=null!==this.ot(t);return e||A("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Pr),this.Ge.getRemoteKeysForTarget(t).forEach(e=>{this.et(t,e,null)})}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function Vr(){return new Ht(it.comparator)}function Ur(){return new Ht(it.comparator)}const jr={asc:"ASCENDING",desc:"DESCENDING"},Br={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qr={and:"AND",or:"OR"};class $r{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function zr(t,e){return t.useProto3Json||Dt(e)?e:{value:e}}function Kr(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gr(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Hr(t,e){return Kr(t,e.toTimestamp())}function Qr(t){return x(!!t,49232),yt.fromTimestamp(function(t){const e=ne(t);return new gt(e.seconds,e.nanos)}(t))}function Wr(t,e){return Xr(t,e).canonicalString()}function Xr(t,e){const n=function(t){return new nt(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Jr(t){const e=nt.fromString(t);return x(ms(e),10190,{key:e.toString()}),e}function Yr(t,e){return Wr(t.databaseId,e.path)}function Zr(t,e){const n=Jr(e);if(n.get(1)!==t.databaseId.projectId)throw new P(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new P(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new it(ns(n))}function ts(t,e){return Wr(t.databaseId,e)}function es(t){return new nt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ns(t){return x(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function rs(t,e,n){return{name:Yr(t,e),fields:n.value.mapValue.fields}}function ss(t,e){return{documents:[ts(t,e.path)]}}function is(t,e){const n={structuredQuery:{}},r=e.path;let s;null!==e.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ts(t,s);const i=function(t){if(0!==t.length)return fs(Qe.create(t,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(t){if(0!==t.length)return t.map(t=>function(t){return{field:hs(t.field),direction:cs(t.dir)}}(t))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=zr(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ft:n,parent:s}}function os(t){let e=function(t){const e=Jr(t);return 4===e.length?nt.emptyPath():ns(e)}(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){x(1===r,65062);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let i=[];n.where&&(i=function(t){const e=as(t);return e instanceof Qe&&Xe(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map(t=>function(t){return new ze(ds(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Dt(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Be(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new Be(n,e)}(n.endAt)),function(t,e,n,r,s,i,o,a){return new pn(t,e,n,r,s,i,o,a)}(e,s,o,i,a,"F",c,u)}function as(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ds(t.unaryFilter.field);return He.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ds(t.unaryFilter.field);return He.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ds(t.unaryFilter.field);return He.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=ds(t.unaryFilter.field);return He.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return R(61313);default:return R(60726)}}(t):void 0!==t.fieldFilter?function(t){return He.create(ds(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return R(58110);default:return R(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Qe.create(t.compositeFilter.filters.map(t=>as(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return R(1026)}}(t.compositeFilter.op))}(t):R(30097,{filter:t})}function cs(t){return jr[t]}function us(t){return Br[t]}function ls(t){return qr[t]}function hs(t){return{fieldPath:t.canonicalString()}}function ds(t){return st.fromServerFormat(t.fieldPath)}function fs(t){return t instanceof He?function(t){if("=="===t.op){if(xe(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NAN"}};if(Oe(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(xe(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NAN"}};if(Oe(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hs(t.field),op:us(t.op),value:t.value}}}(t):t instanceof Qe?function(t){const e=t.getFilters().map(t=>fs(t));return 1===e.length?e[0]:{compositeFilter:{op:ls(t.op),filters:e}}}(t):R(54877,{filter:t})}function ps(t){const e=[];return t.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ms(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class gs{constructor(t,e,n,r,s=yt.min(),i=yt.min(),o=te.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new gs(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class ys{constructor(t){this.yt=t}}function ws(t){const e=os({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?En(e,e.limit,"L"):e}class vs{constructor(){}Dt(t,e){this.Ct(t,e),e.vt()}Ct(t,e){if("nullValue"in t)this.Ft(e,5);else if("booleanValue"in t)this.Ft(e,10),e.Mt(t.booleanValue?1:0);else if("integerValue"in t)this.Ft(e,15),e.Mt(re(t.integerValue));else if("doubleValue"in t){const n=re(t.doubleValue);isNaN(n)?this.Ft(e,13):(this.Ft(e,15),Nt(n)?e.Mt(0):e.Mt(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Ft(e,20),"string"==typeof n&&(n=ne(n)),e.xt(`${n.seconds||""}`),e.Mt(n.nanos||0)}else if("stringValue"in t)this.Ot(t.stringValue,e),this.Nt(e);else if("bytesValue"in t)this.Ft(e,30),e.Bt(se(t.bytesValue)),this.Nt(e);else if("referenceValue"in t)this.Lt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Ft(e,45),e.Mt(n.latitude||0),e.Mt(n.longitude||0)}else"mapValue"in t?Fe(t)?this.Ft(e,Number.MAX_SAFE_INTEGER):Me(t)?this.kt(t.mapValue,e):(this.qt(t.mapValue,e),this.Nt(e)):"arrayValue"in t?(this.Qt(t.arrayValue,e),this.Nt(e)):R(19022,{$t:t})}Ot(t,e){this.Ft(e,25),this.Ut(t,e)}Ut(t,e){e.xt(t)}qt(t,e){const n=t.fields||{};this.Ft(e,55);for(const t of Object.keys(n))this.Ot(t,e),this.Ct(n[t],e)}kt(t,e){const n=t.fields||{};this.Ft(e,53);const r=ve,s=n[r].arrayValue?.values?.length||0;this.Ft(e,15),e.Mt(re(s)),this.Ot(r,e),this.Ct(n[r],e)}Qt(t,e){const n=t.values||[];this.Ft(e,50);for(const t of n)this.Ct(t,e)}Lt(t,e){this.Ft(e,37),it.fromName(t).path.forEach(t=>{this.Ft(e,60),this.Ut(t,e)})}Ft(t,e){t.Mt(e)}Nt(t){t.Mt(2)}}vs.Kt=new vs;class bs{constructor(){this.Cn=new Es}addToCollectionParentIndex(t,e){return this.Cn.add(e),St.resolve()}getCollectionParents(t,e){return St.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return St.resolve()}deleteFieldIndex(t,e){return St.resolve()}deleteAllFieldIndexes(t){return St.resolve()}createTargetIndexes(t,e){return St.resolve()}getDocumentsMatchingTarget(t,e){return St.resolve(null)}getIndexType(t,e){return St.resolve(0)}getFieldIndexes(t,e){return St.resolve([])}getNextCollectionGroupToUpdate(t){return St.resolve(null)}getMinOffset(t,e){return St.resolve(vt.min())}getMinOffsetFromCollectionGroup(t,e){return St.resolve(vt.min())}updateCollectionGroup(t,e,n){return St.resolve()}updateIndexEntries(t,e){return St.resolve()}}class Es{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Xt(nt.comparator),s=!r.has(n);return this.index[e]=r.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new Xt(nt.comparator)).toArray()}}new Uint8Array(0);const Ts={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_s=41943040;class Ss{static withCacheSize(t){return new Ss(t,Ss.DEFAULT_COLLECTION_PERCENTILE,Ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}Ss.DEFAULT_COLLECTION_PERCENTILE=10,Ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ss.DEFAULT=new Ss(_s,Ss.DEFAULT_COLLECTION_PERCENTILE,Ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ss.DISABLED=new Ss(-1,0,0);class Cs{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Cs(0)}static cr(){return new Cs(-1)}}const Is="LruGarbageCollector";function As([t,e],[n,r]){const s=Q(t,n);return 0===s?Q(e,r):s}class Ds{constructor(t){this.Ir=t,this.buffer=new Xt(As),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();As(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Ns{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(t){A(Is,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ct(t)?A(Is,"Ignoring IndexedDB error during garbage collection: ",t):await _t(t)}await this.Vr(3e5)})}}class ks{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next(t=>Math.floor(e/100*t))}nthSequenceNumber(t,e){if(0===e)return St.resolve(It.ce);const n=new Ds(e);return this.mr.forEachTarget(t,t=>n.Ar(t.sequenceNumber)).next(()=>this.mr.pr(t,t=>n.Ar(t))).next(()=>n.maxValue)}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),St.resolve(Ts)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ts):this.yr(t,e))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,r,s,i,o,c,u;const l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(e>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${e}`),r=this.params.maximumSequenceNumbersToCollect):r=e,i=Date.now(),this.nthSequenceNumber(t,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(t,n,e))).next(e=>(s=e,c=Date.now(),this.removeOrphanedDocuments(t,n))).next(t=>(u=Date.now(),I()<=a.$b.DEBUG&&A("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-l}ms\n\tDetermined least recently used ${r} in `+(o-i)+"ms\n"+`\tRemoved ${s} targets in `+(c-o)+"ms\n"+`\tRemoved ${t} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),St.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:t})))}}class Rs{constructor(){this.changes=new Dn(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,je.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?St.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Os{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class xs{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(n=r,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&ur(n.mutation,t,Yt.empty(),gt.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,Un()).next(()=>e))}getLocalViewOfDocuments(t,e,n=Un()){const r=Ln();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,n).next(t=>{let e=On();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=Ln();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,Un()))}populateOverlays(t,e,n){const r=[];return n.forEach(t=>{e.has(t)||r.push(t)}),this.documentOverlayCache.getOverlays(t,r).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,r){let s=kn();const i=Pn(),o=Pn();return e.forEach((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof fr)?s=s.insert(e.key,e):void 0!==o?(i.set(e.key,o.mutation.getFieldMask()),ur(o.mutation,e,o.mutation.getFieldMask(),gt.now())):i.set(e.key,Yt.empty())}),this.recalculateAndSaveOverlays(t,s).next(t=>(t.forEach((t,e)=>i.set(t,e)),e.forEach((t,e)=>o.set(t,new Os(e,i.get(t)??null))),o))}recalculateAndSaveOverlays(t,e){const n=Pn();let r=new Ht((t,e)=>t-e),s=Un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const s of t)s.keys().forEach(t=>{const i=e.get(t);if(null===i)return;let o=n.get(t)||Yt.empty();o=s.applyToLocalView(i,o),n.set(t,o);const a=(r.get(s.batchId)||Un()).add(t);r=r.insert(s.batchId,a)})}).next(()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=Mn();c.forEach(t=>{if(!s.has(t)){const r=ar(e.get(t),n.get(t));null!==r&&u.set(t,r),s=s.add(t)}}),i.push(this.documentOverlayCache.saveOverlays(t,a,u))}return St.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return it.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):yn(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next(s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-s.size):St.resolve(Ln());let o=-1,a=s;return i.next(e=>St.forEach(e,(e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(e)?St.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{a=a.insert(e,t)}))).next(()=>this.populateOverlays(t,e,s)).next(()=>this.computeViews(t,a,e,Un())).next(t=>({batchId:o,changes:xn(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new it(e)).next(t=>{let e=On();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const s=e.collectionGroup;let i=On();return this.indexManager.getCollectionParents(t,s).next(o=>St.forEach(o,o=>{const a=function(t,e){return new pn(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(s));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next(t=>{t.forEach((t,e)=>{i=i.insert(t,e)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,s,r))).next(t=>{s.forEach((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,je.newInvalidDocument(r)))});let n=On();return t.forEach((t,r)=>{const i=s.get(t);void 0!==i&&ur(i.mutation,r,Yt.empty(),gt.now()),Cn(e,r)&&(n=n.insert(t,r))}),n})}}class Ls{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return St.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Qr(t.createTime)}}(e)),St.resolve()}getNamedQuery(t,e){return St.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,function(t){return{name:t.name,query:ws(t.bundledQuery),readTime:Qr(t.readTime)}}(e)),St.resolve()}}class Ms{constructor(){this.overlays=new Ht(it.comparator),this.qr=new Map}getOverlay(t,e){return St.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Ln();return St.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,r)=>{this.St(t,e,r)}),St.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(t=>this.overlays=this.overlays.remove(t)),this.qr.delete(n)),St.resolve()}getOverlaysForCollection(t,e,n){const r=Ln(),s=e.length+1,i=new it(e.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const t=o.getNext().value,i=t.getKey();if(!e.isPrefixOf(i.path))break;i.path.length===s&&t.largestBatchId>n&&r.set(t.getKey(),t)}return St.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let s=new Ht((t,e)=>t-e);const i=this.overlays.getIterator();for(;i.hasNext();){const t=i.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=Ln(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Ln(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((t,e)=>o.set(t,e)),!(o.size()>=r)););return St.resolve(o)}St(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Er(e,n));let s=this.qr.get(e);void 0===s&&(s=Un(),this.qr.set(e,s)),this.qr.set(e,s.add(n.key))}}class Ps{constructor(){this.sessionToken=te.EMPTY_BYTE_STRING}getSessionToken(t){return St.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,St.resolve()}}class Fs{constructor(){this.Qr=new Xt(Vs.$r),this.Ur=new Xt(Vs.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new Vs(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.Gr(new Vs(t,e))}zr(t,e){t.forEach(t=>this.removeReference(t,e))}jr(t){const e=new it(new nt([])),n=new Vs(e,t),r=new Vs(e,t+1),s=[];return this.Ur.forEachInRange([n,r],t=>{this.Gr(t),s.push(t.key)}),s}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new it(new nt([])),n=new Vs(e,t),r=new Vs(e,t+1);let s=Un();return this.Ur.forEachInRange([n,r],t=>{s=s.add(t.key)}),s}containsKey(t){const e=new Vs(t,0),n=this.Qr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Vs{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return it.comparator(t.key,e.key)||Q(t.Yr,e.Yr)}static Kr(t,e){return Q(t.Yr,e.Yr)||it.comparator(t.key,e.key)}}class Us{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new Xt(Vs.$r)}checkEmpty(t){return St.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new vr(s,e,n,r);this.mutationQueue.push(i);for(const e of r)this.Zr=this.Zr.add(new Vs(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return St.resolve(i)}lookupMutationBatch(t,e){return St.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.ei(n),s=r<0?0:r;return St.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return St.resolve(0===this.mutationQueue.length?At:this.tr-1)}getAllMutationBatches(t){return St.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Vs(e,0),r=new Vs(e,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,r],t=>{const e=this.Xr(t.Yr);s.push(e)}),St.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Xt(Q);return e.forEach(t=>{const e=new Vs(t,0),r=new Vs(t,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([e,r],t=>{n=n.add(t.Yr)})}),St.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let s=n;it.isDocumentKey(s)||(s=s.child(""));const i=new Vs(new it(s),0);let o=new Xt(Q);return this.Zr.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.Yr)),!0)},i),St.resolve(this.ti(o))}ti(t){const e=[];return t.forEach(t=>{const n=this.Xr(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){x(0===this.ni(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return St.forEach(e.mutations,r=>{const s=new Vs(r.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Zr=n})}ir(t){}containsKey(t,e){const n=new Vs(e,0),r=this.Zr.firstAfterOrEqual(n);return St.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,St.resolve()}ni(t,e){return this.ei(t)}ei(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class js{constructor(t){this.ri=t,this.docs=new Ht(it.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),s=r?r.size:0,i=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return St.resolve(n?n.document.mutableCopy():je.newInvalidDocument(e))}getEntries(t,e){let n=kn();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():je.newInvalidDocument(t))}),St.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let s=kn();const i=e.path,o=new it(i.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!i.isPrefixOf(t.path))break;t.path.length>i.length+1||bt(wt(o),n)<=0||(r.has(o.key)||Cn(e,o))&&(s=s.insert(o.key,o.mutableCopy()))}return St.resolve(s)}getAllFromCollectionGroup(t,e,n,r){R(9500)}ii(t,e){return St.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new Bs(this)}getSize(t){return St.resolve(this.size)}}class Bs extends Rs{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?e.push(this.Nr.addEntry(t,r)):this.Nr.removeEntry(n)}),St.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class qs{constructor(t){this.persistence=t,this.si=new Dn(t=>hn(t),dn),this.lastRemoteSnapshotVersion=yt.min(),this.highestTargetId=0,this.oi=0,this._i=new Fs,this.targetCount=0,this.ai=Cs.ur()}forEachTarget(t,e){return this.si.forEach((t,n)=>e(n)),St.resolve()}getLastRemoteSnapshotVersion(t){return St.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return St.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),St.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),St.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Cs(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,St.resolve()}updateTargetData(t,e){return this.Pr(e),St.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,St.resolve()}removeTargets(t,e,n){let r=0;const s=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.si.delete(i),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)}),St.waitFor(s).next(()=>r)}getTargetCount(t){return St.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return St.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),St.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const r=this.persistence.referenceDelegate,s=[];return r&&e.forEach(e=>{s.push(r.markPotentiallyOrphaned(t,e))}),St.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),St.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return St.resolve(n)}containsKey(t,e){return St.resolve(this._i.containsKey(e))}}class $s{constructor(t,e){this.ui={},this.overlays={},this.ci=new It(0),this.li=!1,this.li=!0,this.hi=new Ps,this.referenceDelegate=t(this),this.Pi=new qs(this),this.indexManager=new bs,this.remoteDocumentCache=function(t){return new js(t)}(t=>this.referenceDelegate.Ti(t)),this.serializer=new ys(e),this.Ii=new Ls(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Ms,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new Us(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){A("MemoryPersistence","Starting transaction:",t);const r=new zs(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(t=>this.referenceDelegate.di(r).next(()=>t)).toPromise().then(t=>(r.raiseOnCommittedEvent(),t))}Ai(t,e){return St.or(Object.values(this.ui).map(n=>()=>n.containsKey(t,e)))}}class zs extends Tt{constructor(t){super(),this.currentSequenceNumber=t}}class Ks{constructor(t){this.persistence=t,this.Ri=new Fs,this.Vi=null}static mi(t){return new Ks(t)}get fi(){if(this.Vi)return this.Vi;throw R(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),St.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),St.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),St.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach(t=>this.fi.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.fi.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return St.forEach(this.fi,n=>{const r=it.fromPath(n);return this.gi(t,r).next(t=>{t||e.removeEntry(r,yt.min())})}).next(()=>(this.Vi=null,e.apply(t)))}updateLimboDocument(t,e){return this.gi(t,e).next(t=>{t?this.fi.delete(e.toString()):this.fi.add(e.toString())})}Ti(t){return 0}gi(t,e){return St.or([()=>St.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Gs{constructor(t,e){this.persistence=t,this.pi=new Dn(t=>function(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Rt(e)),e=kt(t.get(n),e);return Rt(e)}(t.path),(t,e)=>t.isEqual(e)),this.garbageCollector=function(t,e){return new ks(t,e)}(this,e)}static mi(t,e){return new Gs(t,e)}Ei(){}di(t){return St.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(t=>e.next(e=>t+e))}wr(t){let e=0;return this.pr(t,t=>{e++}).next(()=>e)}pr(t,e){return St.forEach(this.pi,(n,r)=>this.br(t,n,r).next(t=>t?St.resolve():e(r)))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(t,r=>this.br(t,r,e).next(t=>{t||(n++,s.removeEntry(r,yt.min()))})).next(()=>s.apply(t)).next(()=>n)}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),St.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),St.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),St.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),St.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=De(t.data.value)),e}br(t,e,n){return St.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.pi.get(e);return St.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class Hs{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=r}static As(t,e){let n=Un(),r=Un();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new Hs(t,e.fromCache,n,r)}}class Qs{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Ws{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,c.nr)()?8:function(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}((0,c.ZQ)())>0?6:4}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,r){const s={result:null};return this.ys(t,e).next(t=>{s.result=t}).next(()=>{if(!s.result)return this.ws(t,e,r,n).next(t=>{s.result=t})}).next(()=>{if(s.result)return;const n=new Qs;return this.Ss(t,e,n).next(r=>{if(s.result=r,this.Vs)return this.bs(t,e,n,r.size)})}).next(()=>s.result)}bs(t,e,n,r){return n.documentReadCount<this.fs?(I()<=a.$b.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",Sn(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),St.resolve()):(I()<=a.$b.DEBUG&&A("QueryEngine","Query:",Sn(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(I()<=a.$b.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",Sn(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,vn(e))):St.resolve())}ys(t,e){if(gn(e))return St.resolve(null);let n=vn(e);return this.indexManager.getIndexType(t,n).next(r=>0===r?null:(null!==e.limit&&1===r&&(e=En(e,null,"F"),n=vn(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(r=>{const s=Un(...r);return this.ps.getDocuments(t,s).next(r=>this.indexManager.getMinOffset(t,n).next(n=>{const i=this.Ds(e,r);return this.Cs(e,i,s,n.readTime)?this.ys(t,En(e,null,"F")):this.vs(t,i,e,n)}))})))}ws(t,e,n,r){return gn(e)||r.isEqual(yt.min())?St.resolve(null):this.ps.getDocuments(t,n).next(s=>{const i=this.Ds(e,s);return this.Cs(e,i,n,r)?St.resolve(null):(I()<=a.$b.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Sn(e)),this.vs(t,i,e,function(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=yt.fromTimestamp(1e9===r?new gt(n+1,0):new gt(n,r));return new vt(s,it.empty(),e)}(r,-1)).next(t=>t))})}Ds(t,e){let n=new Xt(In(t));return e.forEach((e,r)=>{Cn(t,r)&&(n=n.add(r))}),n}Cs(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(t,e,n){return I()<=a.$b.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",Sn(e)),this.ps.getDocumentsMatchingQuery(t,e,vt.min(),n)}vs(t,e,n,r){return this.ps.getDocumentsMatchingQuery(t,n,r).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}const Xs="LocalStore",Js=3e8;class Ys{constructor(t,e,n,r){this.persistence=t,this.Fs=e,this.serializer=r,this.Ms=new Ht(Q),this.xs=new Dn(t=>hn(t),dn),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new xs(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ms))}}async function Zs(t,e){const n=L(t);return await n.persistence.runTransaction("Handle user change","readonly",t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next(s=>(r=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const s=[],i=[];let o=Un();for(const t of r){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next(t=>({Ls:t,removedBatchIds:s,addedBatchIds:i}))})})}function ti(t){const e=L(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function ei(t,e){const n=L(t);return n.persistence.runTransaction("Get next mutation batch","readonly",t=>(void 0===e&&(e=At),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e)))}async function ni(t,e,n){const r=L(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,t=>r.persistence.referenceDelegate.removeTarget(t,s))}catch(t){if(!Ct(t))throw t;A(Xs,`Failed to update sequence numbers for target ${e}: ${t}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function ri(t,e,n){const r=L(t);let s=yt.min(),i=Un();return r.persistence.runTransaction("Execute query","readwrite",t=>function(t,e,n){const r=L(t),s=r.xs.get(n);return void 0!==s?St.resolve(r.Ms.get(s)):r.Pi.getTargetData(e,n)}(r,t,vn(e)).next(e=>{if(e)return s=e.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(t,e.targetId).next(t=>{i=t})}).next(()=>r.Fs.getDocumentsMatchingQuery(t,e,n?s:yt.min(),n?i:Un())).next(t=>(function(t,e,n){let r=t.Os.get(e)||yt.min();n.forEach((t,e)=>{e.readTime.compareTo(r)>0&&(r=e.readTime)}),t.Os.set(e,r)}(r,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,Qs:i})))}class si{constructor(){this.activeTargetIds=jn}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class ii{constructor(){this.Mo=new si,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new si,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class oi{Oo(t){}shutdown(){}}const ai="ConnectivityMonitor";class ci{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){A(ai,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){A(ai,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ui=null;function li(){return null===ui?ui=268435456+Math.round(2147483648*Math.random()):ui++,"0x"+ui.toString(16)}const hi="RestConnection",di={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fi{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===fe?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(t,e,n,r,s){const i=li(),o=this.zo(t,e.toUriEncodedString());A(hi,`Sending RPC '${t}' ${i}:`,o,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,s);const{host:u}=new URL(o),l=(0,c.zJ)(u);return this.Jo(t,o,a,n,l).then(e=>(A(hi,`Received RPC '${t}' ${i}: `,e),e),e=>{throw N(hi,`RPC '${t}' ${i} failed with error: `,e,"url: ",o,"request:",n),e})}Ho(t,e,n,r,s,i){return this.Go(t,e,n,r,s)}jo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+S,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}zo(t,e){const n=di[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}class pi{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const mi="WebChannelConnection";class gi extends fi{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,r,s){const i=li();return new Promise((s,o)=>{const a=new h;a.setWithCredentials(!0),a.listenOnce(f.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case p.NO_ERROR:const e=a.getResponseJson();A(mi,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(e)),s(e);break;case p.TIMEOUT:A(mi,`RPC '${t}' ${i} timed out`),o(new P(M.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=a.getStatus();if(A(mi,`RPC '${t}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=t?.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(e)>=0?e:M.UNKNOWN}(e.status);o(new P(t,e.message))}else o(new P(M.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new P(M.UNAVAILABLE,"Connection failed."));break;default:R(9055,{l_:t,streamId:i,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{A(mi,`RPC '${t}' ${i} completed.`)}});const c=JSON.stringify(r);A(mi,`RPC '${t}' ${i} sending request:`,r),a.send(e,"POST",c,n,15)})}T_(t,e,n){const r=li(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=w(),o=y(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const u=s.join("");A(mi,`Creating RPC '${t}' stream ${r}: ${u}`,a);const l=i.createWebChannel(u,a);this.I_(l);let h=!1,f=!1;const p=new pi({Yo:e=>{f?A(mi,`Not sending because RPC '${t}' stream ${r} is closed:`,e):(h||(A(mi,`Opening RPC '${t}' stream ${r} transport.`),l.open(),h=!0),A(mi,`RPC '${t}' stream ${r} sending:`,e),l.send(e))},Zo:()=>l.close()}),v=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return v(l,d.EventType.OPEN,()=>{f||(A(mi,`RPC '${t}' stream ${r} transport opened.`),p.o_())}),v(l,d.EventType.CLOSE,()=>{f||(f=!0,A(mi,`RPC '${t}' stream ${r} transport closed`),p.a_(),this.E_(l))}),v(l,d.EventType.ERROR,e=>{f||(f=!0,N(mi,`RPC '${t}' stream ${r} transport errored. Name:`,e.name,"Message:",e.message),p.a_(new P(M.UNAVAILABLE,"The operation could not be completed")))}),v(l,d.EventType.MESSAGE,e=>{if(!f){const n=e.data[0];x(!!n,16349);const s=n,i=s?.error||s[0]?.error;if(i){A(mi,`RPC '${t}' stream ${r} received error:`,i);const e=i.status;let n=function(t){const e=_r[t];if(void 0!==e)return Cr(e)}(e),s=i.message;void 0===n&&(n=M.INTERNAL,s="Unknown error status: "+e+" with message "+i.message),f=!0,p.a_(new P(n,s)),l.close()}else A(mi,`RPC '${t}' stream ${r} received:`,n),p.u_(n)}}),v(o,g.STAT_EVENT,e=>{e.stat===m.PROXY?A(mi,`RPC '${t}' stream ${r} detected buffering proxy`):e.stat===m.NOPROXY&&A(mi,`RPC '${t}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(e=>e===t)}}function yi(){return"undefined"!=typeof document?document:null}function wi(t){return new $r(t,!0)}class vi{constructor(t,e,n=1e3,r=1.5,s=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,e-n);r>0&&A("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const bi="PersistentStream";class Ei{constructor(t,e,n,r,s,i,o,a){this.Mi=t,this.S_=n,this.b_=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vi(t,e)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==t?this.M_.reset():e&&e.code===M.RESOURCE_EXHAUSTED?(D(e.toString()),D("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===M.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([t,n])=>{this.D_===e&&this.G_(t,n)},e=>{t(()=>{const t=new P(M.UNKNOWN,"Fetching auth token failed: "+e.message);return this.z_(t)})})}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(t=>{n(()=>this.z_(t))}),this.stream.onMessage(t=>{n(()=>1==++this.F_?this.J_(t):this.onNext(t))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return A(bi,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget(()=>this.D_===t?e():(A(bi,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ti extends Ei{constructor(t,e,n,r,s,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,r,i),this.serializer=s}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:R(39313,{state:t})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(t,e){return t.useProto3Json?(x(void 0===e||"string"==typeof e,58123),te.fromBase64String(e||"")):(x(void 0===e||e instanceof Buffer||e instanceof Uint8Array,16193),te.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?M.UNKNOWN:Cr(t.code);return new P(e,t.message||"")}(o);n=new Mr(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Zr(t,r.document.name),i=Qr(r.document.updateTime),o=r.document.createTime?Qr(r.document.createTime):yt.min(),a=new Ve({mapValue:{fields:r.document.fields}}),c=je.newFoundDocument(s,i,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new xr(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Zr(t,r.document),i=r.readTime?Qr(r.readTime):yt.min(),o=je.newNoDocument(s,i),a=r.removedTargetIds||[];n=new xr([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Zr(t,r.document),i=r.removedTargetIds||[];n=new xr([],i,s,null)}else{if(!("filter"in e))return R(11601,{Rt:e});{e.filter;const t=e.filter;t.targetId;const{count:r=0,unchangedNames:s}=t,i=new Tr(r,s),o=t.targetId;n=new Lr(o,i)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return yt.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?yt.min():e.readTime?Qr(e.readTime):yt.min()}(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=es(this.serializer),e.addTarget=function(t,e){let n;const r=e.target;if(n=fn(r)?{documents:ss(t,r)}:{query:is(t,r).ft},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Gr(t,e.resumeToken);const r=zr(t,e.expectedCount);null!==r&&(n.expectedCount=r)}else if(e.snapshotVersion.compareTo(yt.min())>0){n.readTime=Kr(t,e.snapshotVersion.toTimestamp());const r=zr(t,e.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return R(28987,{purpose:t})}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=es(this.serializer),e.removeTarget=t,this.q_(e)}}class _i extends Ei{constructor(t,e,n,r,s,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,r,i),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return x(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,x(!t.writeResults||0===t.writeResults.length,55816),this.listener.ta()}onNext(t){x(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=function(t,e){return t&&t.length>0?(x(void 0!==e,14353),t.map(t=>function(t,e){let n=t.updateTime?Qr(t.updateTime):Qr(e);return n.isEqual(yt.min())&&(n=Qr(e)),new rr(n,t.transformResults||[])}(t,e))):[]}(t.writeResults,t.commitTime),n=Qr(t.commitTime);return this.listener.na(n,e)}ra(){const t={};t.database=es(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map(t=>function(t,e){let n;if(e instanceof dr)n={update:rs(t,e.key,e.value)};else if(e instanceof yr)n={delete:Yr(t,e.key)};else if(e instanceof fr)n={update:rs(t,e.key,e.data),updateMask:ps(e.fieldMask)};else{if(!(e instanceof wr))return R(16599,{Vt:e.type});n={verify:Yr(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(t=>function(t,e){const n=e.transform;if(n instanceof Qn)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Wn)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Jn)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Zn)return{fieldPath:e.field.canonicalString(),increment:n.Ae};throw R(20930,{transform:e.transform})}(0,t))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Hr(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:R(27497)}(t,e.precondition)),n}(this.serializer,t))};this.q_(e)}}class Si{}class Ci extends Si{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new P(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Go(t,Xr(e,n),r,s,i)).catch(t=>{throw"FirebaseError"===t.name?(t.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new P(M.UNKNOWN,t.toString())})}Ho(t,e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(t,Xr(e,n),r,i,o,s)).catch(t=>{throw"FirebaseError"===t.name?(t.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new P(M.UNKNOWN,t.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Ii{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,"Online"===t&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(D(e),this.aa=!1):A("OnlineStateTracker",e)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Ai="RemoteStore";class Di{constructor(t,e,n,r,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(t=>{n.enqueueAndForget(async()=>{Fi(this)&&(A(Ai,"Restarting streams for network reachability change."),await async function(t){const e=L(t);e.Ea.add(4),await ki(e),e.Ra.set("Unknown"),e.Ea.delete(4),await Ni(e)}(this))})}),this.Ra=new Ii(n,r)}}async function Ni(t){if(Fi(t))for(const e of t.da)await e(!0)}async function ki(t){for(const e of t.da)await e(!1)}function Ri(t,e){const n=L(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Pi(n)?Mi(n):eo(n).O_()&&xi(n,e))}function Oi(t,e){const n=L(t),r=eo(n);n.Ia.delete(e),r.O_()&&Li(n,e),0===n.Ia.size&&(r.O_()?r.L_():Fi(n)&&n.Ra.set("Unknown"))}function xi(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(yt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}eo(t).Y_(e)}function Li(t,e){t.Va.Ue(e),eo(t).Z_(e)}function Mi(t){t.Va=new Fr({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),eo(t).start(),t.Ra.ua()}function Pi(t){return Fi(t)&&!eo(t).x_()&&t.Ia.size>0}function Fi(t){return 0===L(t).Ea.size}function Vi(t){t.Va=void 0}async function Ui(t){t.Ra.set("Online")}async function ji(t){t.Ia.forEach((e,n)=>{xi(t,e)})}async function Bi(t,e){Vi(t),Pi(t)?(t.Ra.ha(e),Mi(t)):t.Ra.set("Unknown")}async function qi(t,e,n){if(t.Ra.set("Online"),e instanceof Mr&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.Ia.has(r)&&(await t.remoteSyncer.rejectListen(r,n),t.Ia.delete(r),t.Va.removeTarget(r))}(t,e)}catch(n){A(Ai,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await $i(t,n)}else if(e instanceof xr?t.Va.Ze(e):e instanceof Lr?t.Va.st(e):t.Va.tt(e),!n.isEqual(yt.min()))try{const e=await ti(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Va.Tt(e);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=t.Ia.get(r);s&&t.Ia.set(r,s.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach((e,n)=>{const r=t.Ia.get(e);if(!r)return;t.Ia.set(e,r.withResumeToken(te.EMPTY_BYTE_STRING,r.snapshotVersion)),Li(t,e);const s=new gs(r.target,e,n,r.sequenceNumber);xi(t,s)}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){A(Ai,"Failed to raise snapshot:",e),await $i(t,e)}}async function $i(t,e,n){if(!Ct(e))throw e;t.Ea.add(1),await ki(t),t.Ra.set("Offline"),n||(n=()=>ti(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{A(Ai,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ni(t)})}function zi(t,e){return e().catch(n=>$i(t,n,e))}async function Ki(t){const e=L(t),n=no(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:At;for(;Gi(e);)try{const t=await ei(e.localStore,r);if(null===t){0===e.Ta.length&&n.L_();break}r=t.batchId,Hi(e,t)}catch(t){await $i(e,t)}Qi(e)&&Wi(e)}function Gi(t){return Fi(t)&&t.Ta.length<10}function Hi(t,e){t.Ta.push(e);const n=no(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Qi(t){return Fi(t)&&!no(t).x_()&&t.Ta.length>0}function Wi(t){no(t).start()}async function Xi(t){no(t).ra()}async function Ji(t){const e=no(t);for(const n of t.Ta)e.ea(n.mutations)}async function Yi(t,e,n){const r=t.Ta.shift(),s=br.from(r,e,n);await zi(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ki(t)}async function Zi(t,e){e&&no(t).X_&&await async function(t,e){if(function(t){return function(t){switch(t){case M.OK:return R(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return R(15467,{code:t})}}(t)&&t!==M.ABORTED}(e.code)){const n=t.Ta.shift();no(t).B_(),await zi(t,()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e)),await Ki(t)}}(t,e),Qi(t)&&Wi(t)}async function to(t,e){const n=L(t);n.asyncQueue.verifyOperationInProgress(),A(Ai,"RemoteStore received new credentials");const r=Fi(n);n.Ea.add(3),await ki(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ni(n)}function eo(t){return t.ma||(t.ma=function(t,e,n){const r=L(t);return r.sa(),new Ti(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Xo:Ui.bind(null,t),t_:ji.bind(null,t),r_:Bi.bind(null,t),H_:qi.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Pi(t)?Mi(t):t.Ra.set("Unknown")):(await t.ma.stop(),Vi(t))})),t.ma}function no(t){return t.fa||(t.fa=function(t,e,n){const r=L(t);return r.sa(),new _i(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Xi.bind(null,t),r_:Zi.bind(null,t),ta:Ji.bind(null,t),na:Yi.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ki(t)):(await t.fa.stop(),t.Ta.length>0&&(A(Ai,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}class ro{constructor(t,e,n,r,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new F,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,s){const i=Date.now()+n,o=new ro(t,e,i,r,s);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new P(M.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function so(t,e){if(D("AsyncQueue",`${e}: ${t}`),Ct(t))return new P(M.UNAVAILABLE,`${e}: ${t}`);throw t}class io{static emptySet(t){return new io(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||it.comparator(e.key,n.key):(t,e)=>it.comparator(t.key,e.key),this.keyedMap=On(),this.sortedSet=new Ht(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new io;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class oo{constructor(){this.ga=new Ht(it.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?0!==t.type&&3===n.type?this.ga=this.ga.insert(e,t):3===t.type&&1!==n.type?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ga=this.ga.remove(e):1===t.type&&2===n.type?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):R(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal((e,n)=>{t.push(n)}),t}}class ao{constructor(t,e,n,r,s,i,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,r,s){const i=[];return e.forEach(t=>{i.push({type:0,doc:t})}),new ao(t,e,io.emptySet(e),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Tn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class co{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class uo{constructor(){this.queries=lo(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(t,e){const n=L(t),r=n.queries;n.queries=lo(),r.forEach((t,n)=>{for(const t of n.Sa)t.onError(e)})}(this,new P(M.ABORTED,"Firestore shutting down"))}}function lo(){return new Dn(t=>_n(t),Tn)}function ho(t,e){const n=L(t);let r=!1;for(const t of e){const e=t.query,s=n.queries.get(e);if(s){for(const e of s.Sa)e.Fa(t)&&(r=!0);s.wa=t}}r&&po(n)}function fo(t,e,n){const r=L(t),s=r.queries.get(e);if(s)for(const t of s.Sa)t.onError(n);r.queries.delete(e)}function po(t){t.Ca.forEach(t=>{t.next()})}var mo,go;(go=mo||(mo={})).Ma="default",go.Cache="cache";class yo{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new ao(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==e;return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}ka(t){t=ao.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==mo.Cache}}class wo{constructor(t){this.key=t}}class vo{constructor(t){this.key=t}}class bo{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Un(),this.mutatedKeys=Un(),this.eu=In(t),this.tu=new io(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new oo,r=e?e.tu:this.tu;let s=e?e.mutatedKeys:this.mutatedKeys,i=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((t,e)=>{const u=r.get(t),l=Cn(this.query,e)?e:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.su(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.eu(l,a)>0||c&&this.eu(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(i=i.add(l),s=d?s.add(t):s.delete(t)):(i=i.delete(t),s=s.delete(t)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const t="F"===this.query.limitType?i.last():i.first();i=i.delete(t.key),s=s.delete(t.key),n.track({type:1,doc:t})}return{tu:i,iu:n,Cs:o,mutatedKeys:s}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,r){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const i=t.iu.ya();i.sort((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return R(20277,{Rt:t})}};return n(t)-n(e)}(t.type,e.type)||this.eu(t.doc,e.doc)),this.ou(n),r=r??!1;const o=e&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,c=a!==this.Za;return this.Za=a,0!==i.length||c?{snapshot:new ao(this.query,t.tu,s,i,t.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oo,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),t.modifiedDocuments.forEach(t=>{}),t.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Un(),this.tu.forEach(t=>{this.uu(t.key)&&(this.Xa=this.Xa.add(t.key))});const e=[];return t.forEach(t=>{this.Xa.has(t)||e.push(new vo(t))}),this.Xa.forEach(n=>{t.has(n)||e.push(new wo(n))}),e}cu(t){this.Ya=t.Qs,this.Xa=Un();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return ao.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Eo="SyncEngine";class To{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class _o{constructor(t){this.key=t,this.hu=!1}}class So{constructor(t,e,n,r,s,i){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Dn(t=>_n(t),Tn),this.Iu=new Map,this.Eu=new Set,this.du=new Ht(it.comparator),this.Au=new Map,this.Ru=new Fs,this.Vu={},this.mu=new Map,this.fu=Cs.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Co(t,e,n=!0){const r=Ko(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Ao(r,e,n,!0),s}async function Io(t,e){const n=Ko(t);await Ao(n,e,!0,!1)}async function Ao(t,e,n,r){const s=await function(t,e){const n=L(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let r;return n.Pi.getTargetData(t,e).next(s=>s?(r=s,St.resolve(r)):n.Pi.allocateTargetId(t).next(s=>(r=new gs(e,s,"TargetPurposeListen",t.currentSequenceNumber),n.Pi.addTargetData(t,r).next(()=>r))))}).then(t=>{const r=n.Ms.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(t.targetId,t),n.xs.set(e,t.targetId)),t})}(t.localStore,vn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await async function(t,e,n,r,s){t.pu=(e,n,r)=>async function(t,e,n,r){let s=e.view.ru(n);s.Cs&&(s=await ri(t.localStore,e.query,!1).then(({documents:t})=>e.view.ru(t,s)));const i=r&&r.targetChanges.get(e.targetId),o=r&&null!=r.targetMismatches.get(e.targetId),a=e.view.applyChanges(s,t.isPrimaryClient,i,o);return Uo(t,e.targetId,a.au),a.snapshot}(t,e,n,r);const i=await ri(t.localStore,e,!0),o=new bo(e,i.Qs),a=o.ru(i.documents),c=Or.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,s),u=o.applyChanges(a,t.isPrimaryClient,c);Uo(t,n,u.au);const l=new To(e,n,o);return t.Tu.set(e,l),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}(t,e,i,"current"===o,s.resumeToken)),t.isPrimaryClient&&n&&Ri(t.remoteStore,s),a}async function Do(t,e,n){const r=L(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(t=>!Tn(t,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ni(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Oi(r.remoteStore,s.targetId),Fo(r,s.targetId)}).catch(_t)):(Fo(r,s.targetId),await ni(r.localStore,s.targetId,!0))}async function No(t,e){const n=L(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Oi(n.remoteStore,r.targetId))}async function ko(t,e){const n=L(t);try{const t=await function(t,e){const n=L(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const o=[];e.targetChanges.forEach((i,a)=>{const c=s.get(a);if(!c)return;o.push(n.Pi.removeMatchingKeys(t,i.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(t,i.addedDocuments,a)));let u=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?u=u.withResumeToken(te.EMPTY_BYTE_STRING,yt.min()).withLastLimboFreeSnapshotVersion(yt.min()):i.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(i.resumeToken,r)),s=s.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=Js||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,i)&&o.push(n.Pi.updateTargetData(t,u))});let a=kn(),c=Un();if(e.documentUpdates.forEach(r=>{e.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),o.push(function(t,e,n){let r=Un(),s=Un();return n.forEach(t=>r=r.add(t)),e.getEntries(t,r).next(t=>{let r=kn();return n.forEach((n,i)=>{const o=t.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(yt.min())?(e.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(i),r=r.insert(n,i)):A(Xs,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)}),{ks:r,qs:s}})}(t,i,e.documentUpdates).next(t=>{a=t.ks,c=t.qs})),!r.isEqual(yt.min())){const e=n.Pi.getLastRemoteSnapshotVersion(t).next(e=>n.Pi.setTargetsMetadata(t,t.currentSequenceNumber,r));o.push(e)}return St.waitFor(o).next(()=>i.apply(t)).next(()=>n.localDocuments.getLocalViewOfDocuments(t,a,c)).next(()=>a)}).then(t=>(n.Ms=s,t))}(n.localStore,e);e.targetChanges.forEach((t,e)=>{const r=n.Au.get(e);r&&(x(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?r.hu=!0:t.modifiedDocuments.size>0?x(r.hu,14607):t.removedDocuments.size>0&&(x(r.hu,42227),r.hu=!1))}),await qo(n,t,e)}catch(t){await _t(t)}}function Ro(t,e,n){const r=L(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.Tu.forEach((n,r)=>{const s=r.view.va(e);s.snapshot&&t.push(s.snapshot)}),function(t,e){const n=L(t);n.onlineState=e;let r=!1;n.queries.forEach((t,n)=>{for(const t of n.Sa)t.va(e)&&(r=!0)}),r&&po(n)}(r.eventManager,e),t.length&&r.Pu.H_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Oo(t,e,n){const r=L(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let t=new Ht(it.comparator);t=t.insert(i,je.newNoDocument(i,yt.min()));const n=Un().add(i),s=new Rr(yt.min(),new Map,new Ht(Q),t,n);await ko(r,s),r.du=r.du.remove(i),r.Au.delete(e),Bo(r)}else await ni(r.localStore,e,!1).then(()=>Fo(r,e,n)).catch(_t)}async function xo(t,e){const n=L(t),r=e.batch.batchId;try{const t=await function(t,e){const n=L(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",t=>{const r=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){const s=n.batch,i=s.keys();let o=St.resolve();return i.forEach(t=>{o=o.next(()=>r.getEntry(e,t)).next(e=>{const i=n.docVersions.get(t);x(null!==i,48541),e.version.compareTo(i)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))})}),o.next(()=>t.mutationQueue.removeMutationBatch(e,s))}(n,t,e,s).next(()=>s.apply(t)).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Un();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e))).next(()=>n.localDocuments.getDocuments(t,r))})}(n.localStore,e);Po(n,r,null),Mo(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await qo(n,t)}catch(t){await _t(t)}}async function Lo(t,e,n){const r=L(t);try{const t=await function(t,e){const n=L(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let r;return n.mutationQueue.lookupMutationBatch(t,e).next(e=>(x(null!==e,37113),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e))).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r)).next(()=>n.localDocuments.getDocuments(t,r))})}(r.localStore,e);Po(r,e,n),Mo(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await qo(r,t)}catch(n){await _t(n)}}function Mo(t,e){(t.mu.get(e)||[]).forEach(t=>{t.resolve()}),t.mu.delete(e)}function Po(t,e,n){const r=L(t);let s=r.Vu[r.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Fo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(e=>{t.Ru.containsKey(e)||Vo(t,e)})}function Vo(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);null!==n&&(Oi(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Bo(t))}function Uo(t,e,n){for(const r of n)r instanceof wo?(t.Ru.addReference(r.key,e),jo(t,r)):r instanceof vo?(A(Eo,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Vo(t,r.key)):R(19791,{wu:r})}function jo(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(A(Eo,"New document in limbo: "+n),t.Eu.add(r),Bo(t))}function Bo(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new it(nt.fromString(e)),r=t.fu.next();t.Au.set(r,new _o(n)),t.du=t.du.insert(n,r),Ri(t.remoteStore,new gs(vn(mn(n.path)),r,"TargetPurposeLimboResolution",It.ce))}}async function qo(t,e,n){const r=L(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((t,a)=>{o.push(r.pu(a,e,n).then(t=>{if((t||n)&&r.isPrimaryClient){const e=t?!t.fromCache:n?.targetChanges.get(a.targetId)?.current;r.sharedClientState.updateQueryState(a.targetId,e?"current":"not-current")}if(t){s.push(t);const e=Hs.As(a.targetId,t);i.push(e)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(t,e){const n=L(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>St.forEach(e,e=>St.forEach(e.Es,r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r)).next(()=>St.forEach(e.ds,r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))}catch(t){if(!Ct(t))throw t;A(Xs,"Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,s)}}}(r.localStore,i))}async function $o(t,e){const n=L(t);if(!n.currentUser.isEqual(e)){A(Eo,"User change. New user:",e.toKey());const t=await Zs(n.localStore,e);n.currentUser=e,function(t){t.mu.forEach(t=>{t.forEach(t=>{t.reject(new P(M.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.mu.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await qo(n,t.Ls)}}function zo(t,e){const n=L(t),r=n.Au.get(e);if(r&&r.hu)return Un().add(r.key);{let t=Un();const r=n.Iu.get(e);if(!r)return t;for(const e of r){const r=n.Tu.get(e);t=t.unionWith(r.view.nu)}return t}}function Ko(t){const e=L(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ko.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zo.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Oo.bind(null,e),e.Pu.H_=ho.bind(null,e.eventManager),e.Pu.yu=fo.bind(null,e.eventManager),e}function Go(t){const e=L(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xo.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Lo.bind(null,e),e}class Ho{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=wi(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return function(t,e,n,r){return new Ys(t,e,n,r)}(this.persistence,new Ws,t.initialUser,this.serializer)}Cu(t){return new $s(Ks.mi,this.serializer)}Du(t){return new ii}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ho.provider={build:()=>new Ho};class Qo extends Ho{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){x(this.persistence.referenceDelegate instanceof Gs,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ns(n,t.asyncQueue,e)}Cu(t){const e=void 0!==this.cacheSizeBytes?Ss.withCacheSize(this.cacheSizeBytes):Ss.DEFAULT;return new $s(t=>Gs.mi(t,e),this.serializer)}}class Wo{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Ro(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=$o.bind(null,this.syncEngine),await async function(t,e){const n=L(t);e?(n.Ea.delete(2),await Ni(n)):e||(n.Ea.add(2),await ki(n),n.Ra.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new uo}createDatastore(t){const e=wi(t.databaseInfo.databaseId),n=function(t){return new gi(t)}(t.databaseInfo);return function(t,e,n,r){return new Ci(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,s){return new Di(t,e,n,r,s)}(this.localStore,this.datastore,t.asyncQueue,t=>Ro(this.syncEngine,t,0),ci.v()?new ci:new oi)}createSyncEngine(t,e){return function(t,e,n,r,s,i,o){const a=new So(t,e,n,r,s,i);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await async function(t){const e=L(t);A(Ai,"RemoteStore shutting down."),e.Ea.add(5),await ki(e),e.Aa.shutdown(),e.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Wo.provider={build:()=>new Wo};class Xo{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):D("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout(()=>{this.muted||t(e)},0)}}const Jo="FirestoreClient";class Yo{constructor(t,e,n,r,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=_.UNAUTHENTICATED,this.clientId=H.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async t=>{A(Jo,"Received user=",t.uid),await this.authCredentialListener(t),this.user=t}),this.appCheckCredentials.start(n,t=>(A(Jo,"Received new app check token=",t),this.appCheckCredentialListener(t,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new F;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=so(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Zo(t,e){t.asyncQueue.verifyOperationInProgress(),A(Jo,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async t=>{r.isEqual(t)||(await Zs(e.localStore,t),r=t)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ta(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){A(Jo,"Using user provided OfflineComponentProvider");try{await Zo(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===M.FAILED_PRECONDITION||t.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;N("Error using user provided cache. Falling back to memory cache: "+n),await Zo(t,new Ho)}}else A(Jo,"Using default OfflineComponentProvider"),await Zo(t,new Qo(void 0));return t._offlineComponents}(t);A(Jo,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(t=>to(e.remoteStore,t)),t.setAppCheckTokenChangeListener((t,n)=>to(e.remoteStore,n)),t._onlineComponents=e}async function ea(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(A(Jo,"Using user provided OnlineComponentProvider"),await ta(t,t._uninitializedComponentsProvider._online)):(A(Jo,"Using default OnlineComponentProvider"),await ta(t,new Wo))),t._onlineComponents}async function na(t){const e=await ea(t),n=e.eventManager;return n.onListen=Co.bind(null,e.syncEngine),n.onUnlisten=Do.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Io.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=No.bind(null,e.syncEngine),n}function ra(t,e,n={}){const r=new F;return t.asyncQueue.enqueueAndForget(async()=>function(t,e,n,r,s){const i=new Xo({next:n=>{i.Nu(),e.enqueueAndForget(()=>async function(t,e){const n=L(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const t=i.Sa.indexOf(e);t>=0&&(i.Sa.splice(t,1),0===i.Sa.length?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}(t,o)),n.fromCache&&"server"===r.source?s.reject(new P(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:t=>s.reject(t)}),o=new yo(n,i,{includeMetadataChanges:!0,qa:!0});return async function(t,e){const n=L(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new co,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(t){const n=so(t,`Initialization of query '${Sn(e.query)}' failed`);return void e.onError(n)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&po(n)}(t,o)}(await na(t),t.asyncQueue,e,n,r)),r.promise}function sa(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const ia=new Map,oa="firestore.googleapis.com",aa=!0;class ca{constructor(t){if(void 0===t.host){if(void 0!==t.ssl)throw new P(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=oa,this.ssl=aa}else this.host=t.host,this.ssl=t.ssl??aa;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=_s;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new P(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new P(M.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sa(t.experimentalLongPollingOptions??{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ua{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ca({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new P(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ca(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new U;switch(t.type){case"firstParty":return new $(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new P(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=ia.get(t);e&&(A("ComponentProvider","Removing Datastore"),ia.delete(t),e.terminate())}(this),Promise.resolve()}}class la{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new la(this.firestore,t,this._query)}}class ha{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new da(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ha(this.firestore,t,this._key)}toJSON(){return{type:ha._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(ft(e,ha._jsonSchema))return new ha(t,n||null,new it(nt.fromString(e.referencePath)))}}ha._jsonSchemaVersion="firestore/documentReference/1.0",ha._jsonSchema={type:dt("string",ha._jsonSchemaVersion),referencePath:dt("string")};class da extends la{constructor(t,e,n){super(t,e,mn(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ha(this.firestore,null,new it(t))}withConverter(t){return new da(this.firestore,t,this._path)}}function fa(t,e,...n){if(t=(0,c.Ku)(t),ot("collection","path",e),t instanceof ua){const r=nt.fromString(e,...n);return ct(r),new da(t,null,r)}{if(!(t instanceof ha||t instanceof da))throw new P(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(nt.fromString(e,...n));return ct(r),new da(t.firestore,null,r)}}function pa(t,e,...n){if(t=(0,c.Ku)(t),1===arguments.length&&(e=H.newId()),ot("doc","path",e),t instanceof ua){const r=nt.fromString(e,...n);return at(r),new ha(t,null,new it(r))}{if(!(t instanceof ha||t instanceof da))throw new P(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(nt.fromString(e,...n));return at(r),new ha(t.firestore,t instanceof da?t.converter:null,new it(r))}}const ma="AsyncQueue";class ga{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vi(this,"async_queue_retry"),this._c=()=>{const t=yi();t&&A(ma,"Visibility state changed to "+t.visibilityState),this.M_.w_()},this.ac=t;const e=yi();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=yi();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const e=new F;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Ct(t))throw t;A(ma,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const e=this.ac.then(()=>(this.rc=!0,t().catch(t=>{throw this.nc=t,this.rc=!1,D("INTERNAL UNHANDLED ERROR: ",ya(t)),t}).then(t=>(this.rc=!1,t))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const r=ro.createAndSchedule(this,t,e,n,t=>this.hc(t));return this.tc.push(r),r}uc(){this.nc&&R(47125,{Pc:ya(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do{t=this.ac,await t}while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.tc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function ya(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}class wa extends ua{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new ga,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ga(t),this._firestoreClient=void 0,await t}}}function va(t,e){const n="object"==typeof t?t:(0,i.Sx)(),r="string"==typeof t?t:e||fe,s=(0,i.j6)(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const t=(0,c.yU)("firestore");t&&function(t,e,n,r={}){t=ht(t,ua);const s=(0,c.zJ)(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&((0,c.gE)(`https://${a}`),(0,c.P1)("Firestore",!0)),i.host!==oa&&i.host!==a&&N("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:a,ssl:s,emulatorOptions:r};if(!(0,c.bD)(u,o)&&(t._setSettings(u),r.mockUserToken)){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=_.MOCK_USER;else{e=(0,c.Fy)(r.mockUserToken,t._app?.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new P(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _(s)}t._authCredentials=new j(new V(e,n))}}(s,...t)}return s}function ba(t){if(t._terminated)throw new P(M.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||function(t){const e=t._freezeSettings(),n=function(t,e,n,r){return new de(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,sa(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Yo(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(t){const e=t?._online.build();return{_offline:t?._offline.build(e),_online:e}}(t._componentsProvider))}(t),t._firestoreClient}class Ea{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ea(te.fromBase64String(t))}catch(t){throw new P(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ea(te.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Ea._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(ft(t,Ea._jsonSchema))return Ea.fromBase64String(t.bytes)}}Ea._jsonSchemaVersion="firestore/bytes/1.0",Ea._jsonSchema={type:dt("string",Ea._jsonSchemaVersion),bytes:dt("string")};class Ta{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new P(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class _a{constructor(t){this._methodName=t}}class Sa{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new P(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new P(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Q(this._lat,t._lat)||Q(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Sa._jsonSchemaVersion}}static fromJSON(t){if(ft(t,Sa._jsonSchema))return new Sa(t.latitude,t.longitude)}}Sa._jsonSchemaVersion="firestore/geoPoint/1.0",Sa._jsonSchema={type:dt("string",Sa._jsonSchemaVersion),latitude:dt("number"),longitude:dt("number")};class Ca{constructor(t){this._values=(t||[]).map(t=>t)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Ca._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(ft(t,Ca._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(t=>"number"==typeof t))return new Ca(t.vectorValues);throw new P(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ca._jsonSchemaVersion="firestore/vectorValue/1.0",Ca._jsonSchema={type:dt("string",Ca._jsonSchemaVersion),vectorValues:dt("object")};const Ia=/^__.*__$/;class Aa{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new fr(t,this.data,this.fieldMask,e,this.fieldTransforms):new dr(t,this.data,e,this.fieldTransforms)}}function Da(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw R(40011,{Ac:t})}}class Na{constructor(t,e,n,r,s,i){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new Na({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.gc(t),n}yc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.Rc(),n}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return Ba(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(0===t.length)throw this.Sc("Document fields must not be empty");if(Da(this.Ac)&&Ia.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class ka{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||wi(t)}Cc(t,e,n,r=!1){return new Na({Ac:t,methodName:e,Dc:n,path:st.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ra(t){const e=t._freezeSettings(),n=wi(t._databaseId);return new ka(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Oa(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);Fa("Data must be an object, but it was:",o,r);const a=Ma(r,o);let c,u;if(i.merge)c=new Yt(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const t=[];for(const r of i.mergeFields){const s=Va(e,r,n);if(!o.contains(s))throw new P(M.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);qa(t,s)||t.push(s)}c=new Yt(t),u=o.fieldTransforms.filter(t=>c.covers(t.field))}else c=null,u=o.fieldTransforms;return new Aa(new Ve(a),c,u)}class xa extends _a{_toFieldTransform(t){return new nr(t.path,new Qn)}isEqual(t){return t instanceof xa}}function La(t,e){if(Pa(t=(0,c.Ku)(t)))return Fa("Unsupported field value:",e,t),Ma(t,e);if(t instanceof _a)return function(t,e){if(!Da(e.Ac))throw e.Sc(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Sc(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&4!==e.Ac)throw e.Sc("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const s of t){let t=La(s,e.wc(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,c.Ku)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return $n(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=gt.fromDate(t);return{timestampValue:Kr(e.serializer,n)}}if(t instanceof gt){const n=new gt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Kr(e.serializer,n)}}if(t instanceof Sa)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ea)return{bytesValue:Gr(e.serializer,t._byteString)};if(t instanceof ha){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Wr(t.firestore._databaseId||e.databaseId,t._key.path)}}if(t instanceof Ca)return function(t,e){return{mapValue:{fields:{[me]:{stringValue:we},[ve]:{arrayValue:{values:t.toArray().map(t=>{if("number"!=typeof t)throw e.Sc("VectorValues must only contain numeric values.");return Bn(e.serializer,t)})}}}}}}(t,e);throw e.Sc(`Unsupported field value: ${lt(t)}`)}(t,e)}function Ma(t,e){const n={};return Gt(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Kt(t,(t,r)=>{const s=La(r,e.mc(t));null!=s&&(n[t]=s)}),{mapValue:{fields:n}}}function Pa(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof gt||t instanceof Sa||t instanceof Ea||t instanceof ha||t instanceof _a||t instanceof Ca)}function Fa(t,e,n){if(!Pa(n)||!ut(n)){const r=lt(n);throw"an object"===r?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Va(t,e,n){if((e=(0,c.Ku)(e))instanceof Ta)return e._internalPath;if("string"==typeof e)return ja(t,e);throw Ba("Field path arguments must be of type string or ",t,!1,void 0,n)}const Ua=new RegExp("[~\\*/\\[\\]]");function ja(t,e,n){if(e.search(Ua)>=0)throw Ba(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ta(...e.split("."))._internalPath}catch(r){throw Ba(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ba(t,e,n,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new P(M.INVALID_ARGUMENT,a+t+c)}function qa(t,e){return t.some(t=>t.isEqual(e))}class $a{constructor(t,e,n,r,s){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ha(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new za(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Ka("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class za extends $a{data(){return super.data()}}function Ka(t,e){return"string"==typeof e?ja(t,e):e instanceof Ta?e._internalPath:e._delegate._internalPath}class Ga{}class Ha extends Ga{}function Qa(t,e,...n){let r=[];e instanceof Ga&&r.push(e),r=r.concat(n),function(t){const e=t.filter(t=>t instanceof Xa).length,n=t.filter(t=>t instanceof Wa).length;if(e>1||e>0&&n>0)throw new P(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const e of r)t=e._apply(t);return t}class Wa extends Ha{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new Wa(t,e,n)}_apply(t){const e=this._parse(t);return ec(t._query,e),new la(t.firestore,t.converter,bn(t._query,e))}_parse(t){const e=Ra(t.firestore),n=function(t,e,n,r,s,i,o){let a;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new P(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){tc(o,i);const e=[];for(const n of o)e.push(Za(r,t,n));a={arrayValue:{values:e}}}else a=Za(r,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||tc(o,i),a=function(t,e,n,r=!1){return La(n,t.Cc(r?4:3,e))}(n,"where",o,"in"===i||"not-in"===i);return He.create(s,i,a)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value);return n}}class Xa extends Ga{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Xa(t,e)}_parse(t){const e=this._queryConstraints.map(e=>e._parse(t)).filter(t=>t.getFilters().length>0);return 1===e.length?e[0]:Qe.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const r=e.getFlattenedFilters();for(const t of r)ec(n,t),n=bn(n,t)}(t._query,e),new la(t.firestore,t.converter,bn(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ja extends Ha{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Ja(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new P(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new P(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ze(e,n)}(t._query,this._field,this._direction);return new la(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new pn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function Ya(t,e="asc"){const n=e,r=Ka("orderBy",t);return Ja._create(r,n)}function Za(t,e,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new P(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yn(e)&&-1!==n.indexOf("/"))throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(nt.fromString(n));if(!it.isDocumentKey(r))throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ne(t,new it(r))}if(n instanceof ha)return Ne(t,n._key);throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lt(n)}.`)}function tc(t,e){if(!Array.isArray(t)||0===t.length)throw new P(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ec(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new P(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class nc{convertValue(t,e="none"){switch(be(t)){case 0:return null;case 1:return t.booleanValue;case 2:return re(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(se(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw R(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Kt(t,(t,r)=>{n[t]=this.convertValue(r,e)}),n}convertVectorValue(t){const e=t.fields?.[ve].arrayValue?.values?.map(t=>re(t.doubleValue));return new Ca(e)}convertGeoPoint(t){return new Sa(re(t.latitude),re(t.longitude))}convertArray(t,e){return(t.values||[]).map(t=>this.convertValue(t,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=le(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(he(t));default:return null}}convertTimestamp(t){const e=ne(t);return new gt(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=nt.fromString(t);x(ms(n),9688,{name:t});const r=new pe(n.get(1),n.get(3)),s=new it(n.popFirst(5));return r.isEqual(e)||D(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}class rc{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class sc extends $a{constructor(t,e,n,r,s,i){super(t,e,n,r,i),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ic(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Ka("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new P(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=sc._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),t&&t.isValidDocument()&&t.isFoundDocument()?(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e):e}}sc._jsonSchemaVersion="firestore/documentSnapshot/1.0",sc._jsonSchema={type:dt("string",sc._jsonSchemaVersion),bundleSource:dt("string","DocumentSnapshot"),bundleName:dt("string"),bundle:dt("string")};class ic extends sc{data(t={}){return super.data(t)}}class oc{constructor(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new rc(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new ic(this._firestore,this._userDataWriter,n.key,n,new rc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new P(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map(n=>{const r=new ic(t._firestore,t._userDataWriter,n.doc.key,n.doc,new rc(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:e++}})}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(t=>e||3!==t.type).map(e=>{const r=new ic(t._firestore,t._userDataWriter,e.doc.key,e.doc,new rc(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let s=-1,i=-1;return 0!==e.type&&(s=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),i=n.indexOf(e.doc.key)),{type:ac(e.type),doc:r,oldIndex:s,newIndex:i}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new P(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=oc._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=H.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],r=[];return this.docs.forEach(t=>{null!==t._document&&(e.push(t._document),n.push(this._userDataWriter.convertObjectMap(t._document.data.value.mapValue.fields,"previous")),r.push(t.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function ac(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return R(61501,{type:t})}}oc._jsonSchemaVersion="firestore/querySnapshot/1.0",oc._jsonSchema={type:dt("string",oc._jsonSchemaVersion),bundleSource:dt("string","QuerySnapshot"),bundleName:dt("string"),bundle:dt("string")};class cc extends nc{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ea(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ha(this.firestore,null,e)}}function uc(t){t=ht(t,la);const e=ht(t.firestore,wa),n=ba(e),r=new cc(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new P(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),ra(n,t._query).then(n=>new oc(e,r,t,n))}function lc(t){return dc(ht(t.firestore,wa),[new yr(t._key,sr.none())])}function hc(t,e){const n=ht(t.firestore,wa),r=pa(t),s=function(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}(t.converter,e);return dc(n,[Oa(Ra(t.firestore),"addDoc",r._key,s,null!==t.converter,{}).toMutation(r._key,sr.exists(!1))]).then(()=>r)}function dc(t,e){return function(t,e){const n=new F;return t.asyncQueue.enqueueAndForget(async()=>async function(t,e,n){const r=Go(t);try{const t=await function(t,e){const n=L(t),r=gt.now(),s=e.reduce((t,e)=>t.add(e.key),Un());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",t=>{let a=kn(),c=Un();return n.Ns.getEntries(t,s).next(t=>{a=t,a.forEach((t,e)=>{e.isValidDocument()||(c=c.add(t))})}).next(()=>n.localDocuments.getOverlayedDocuments(t,a)).next(s=>{i=s;const o=[];for(const t of e){const e=lr(t,i.get(t.key).overlayedDocument);null!=e&&o.push(new fr(t.key,e,Ue(e.value.mapValue),sr.exists(!0)))}return n.mutationQueue.addMutationBatch(t,r,o,e)}).next(e=>{o=e;const r=e.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,r)})}).then(()=>({batchId:o.batchId,changes:xn(i)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let r=t.Vu[t.currentUser.toKey()];r||(r=new Ht(Q)),r=r.insert(e,n),t.Vu[t.currentUser.toKey()]=r}(r,t.batchId,n),await qo(r,t.changes),await Ki(r.remoteStore)}catch(t){const e=so(t,"Failed to persist write");n.reject(e)}}(await function(t){return ea(t).then(t=>t.syncEngine)}(t),e,n)),n.promise}(ba(t),e)}function fc(){return new xa("serverTimestamp")}new WeakMap,function(t,e=!0){!function(t){S=t}(i.MF),(0,i.om)(new o.uA("firestore",(t,{instanceIdentifier:n,options:r})=>{const s=t.getProvider("app").getImmediate(),i=new wa(new B(t.getProvider("auth-internal")),new K(s,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new P(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pe(t.options.projectId,e)}(s,n),s);return r={useFetchStreams:e,...r},i._setSettings(r),i},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(E,T,t),(0,i.KO)(E,T,"esm2020")}()},674:(t,e,n)=>{n.d(e,{P2:()=>m});const r=(t,e)=>e.some(e=>t instanceof e);let s,i;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return a.get(t);if("objectStoreNames"===e)return t.objectStoreNames||c.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function d(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(p(this),t),f(o.get(this))}:function(...t){return f(e.apply(p(this),t))}:function(t,...n){const r=e.call(p(this),t,...n);return c.set(r,t.sort?t.sort():[t]),f(r)}:(t instanceof IDBTransaction&&function(t){if(a.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",i),t.removeEventListener("abort",i)},s=()=>{e(),r()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",i),t.addEventListener("abort",i)});a.set(t,e)}(t),r(t,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,h):t);var e}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",i)},s=()=>{e(f(t.result)),r()},i=()=>{n(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",i)});return e.then(e=>{e instanceof IDBCursor&&o.set(e,t)}).catch(()=>{}),l.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=d(t);return e!==t&&(u.set(t,e),l.set(e,t)),e}const p=t=>l.get(t);function m(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=f(o);return r&&o.addEventListener("upgradeneeded",t=>{r(f(o.result),t.oldVersion,t.newVersion,f(o.transaction),t)}),n&&o.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),a.then(t=>{i&&t.addEventListener("close",()=>i()),s&&t.addEventListener("versionchange",t=>s(t.oldVersion,t.newVersion,t))}).catch(()=>{}),a}const g=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],w=new Map;function v(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(w.get(e))return w.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=y.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!g.includes(n))return;const i=async function(t,...e){const i=this.transaction(t,s?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&i.done]))[0]};return w.set(e,i),i}var b;b=h,h={...b,get:(t,e,n)=>v(t,e)||b.get(t,e,n),has:(t,e)=>!!v(t,e)||b.has(t,e)}},728:(t,e,n)=>{n.d(e,{P5:()=>dt});var r=n(333),s=n(812),i=n(99),o=n(873),a=n(674);const c="@firebase/installations",u="0.6.19",l=`w:${u}`,h="FIS_v2",d=new i.FA("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function f(t){return t instanceof i.g&&t.code.includes("request-failed")}function p({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function m(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function g(t,e){const n=(await e.json()).error;return d.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function y({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function w(t){const e=await t();return e.status>=500&&e.status<600?t():e}function v(t){return new Promise(e=>{setTimeout(e,t)})}const b=/^[cdef][\w-]{21}$/;function E(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return b.test(e)?e:""}catch{return""}}function T(t){return`${t.appName}!${t.appId}`}const _=new Map;function S(t,e){const n=T(t);C(n,e),function(t,e){const n=(!I&&"BroadcastChannel"in self&&(I=new BroadcastChannel("[Firebase] FID Change"),I.onmessage=t=>{C(t.data.key,t.data.fid)}),I);n&&n.postMessage({key:t,fid:e}),0===_.size&&I&&(I.close(),I=null)}(n,e)}function C(t,e){const n=_.get(t);if(n)for(const t of n)t(e)}let I=null;const A="firebase-installations-store";let D=null;function N(){return D||(D=(0,a.P2)("firebase-installations-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(A)}})),D}async function k(t,e){const n=T(t),r=(await N()).transaction(A,"readwrite"),s=r.objectStore(A),i=await s.get(n);return await s.put(e,n),await r.done,i&&i.fid===e.fid||S(t,e.fid),e}async function R(t){const e=T(t),n=(await N()).transaction(A,"readwrite");await n.objectStore(A).delete(e),await n.done}async function O(t,e){const n=T(t),r=(await N()).transaction(A,"readwrite"),s=r.objectStore(A),i=await s.get(n),o=e(i);return void 0===o?await s.delete(n):await s.put(o,n),await r.done,!o||i&&i.fid===o.fid||S(t,o.fid),o}async function x(t){let e;const n=await O(t.appConfig,n=>{const r=function(t){return P(t||{fid:E(),registrationStatus:0})}(n),s=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(d.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=p(t),s=y(t),i=e.getImmediate({optional:!0});if(i){const t=await i.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={fid:n,authVersion:h,appId:t.appId,sdkVersion:l},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await w(()=>fetch(r,a));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:m(t.authToken)}}throw await g("Create Installation",c)}(t,e);return k(t.appConfig,n)}catch(n){throw f(n)&&409===n.customData.serverCode?await R(t.appConfig):await k(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:L(t)}:{installationEntry:e}}(t,r);return e=s.registrationPromise,s.installationEntry});return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function L(t){let e=await M(t.appConfig);for(;1===e.registrationStatus;)await v(100),e=await M(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await x(t);return n||e}return e}function M(t){return O(t,t=>{if(!t)throw d.create("installation-not-found");return P(t)})}function P(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function F({appConfig:t,heartbeatServiceProvider:e},n){const r=function(t,{fid:e}){return`${p(t)}/${e}/authTokens:generate`}(t,n),s=function(t,{refreshToken:e}){const n=y(t);return n.append("Authorization",function(t){return`${h} ${t}`}(e)),n}(t,n),i=e.getImmediate({optional:!0});if(i){const t=await i.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={installation:{sdkVersion:l,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await w(()=>fetch(r,a));if(c.ok)return m(await c.json());throw await g("Generate Auth Token",c)}async function V(t,e=!1){let n;const r=await O(t.appConfig,r=>{if(!j(r))throw d.create("not-registered");const s=r.authToken;if(!e&&(2===(i=s).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i)))return r;var i;if(1===s.requestStatus)return n=async function(t,e){let n=await U(t.appConfig);for(;1===n.authToken.requestStatus;)await v(100),n=await U(t.appConfig);const r=n.authToken;return 0===r.requestStatus?V(t,e):r}(t,e),r;{if(!navigator.onLine)throw d.create("app-offline");const e=function(t){return{...t,authToken:{requestStatus:1,requestTime:Date.now()}}}(r);return n=async function(t,e){try{const n=await F(t,e),r={...e,authToken:n};return await k(t.appConfig,r),n}catch(n){if(!f(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n={...e,authToken:{requestStatus:0}};await k(t.appConfig,n)}else await R(t.appConfig);throw n}}(t,e),e}});return n?await n:r.authToken}function U(t){return O(t,t=>{if(!j(t))throw d.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?{...t,authToken:{requestStatus:0}}:t;var e})}function j(t){return void 0!==t&&2===t.registrationStatus}function B(t){return d.create("missing-app-config-values",{valueName:t})}const q="installations";(0,r.om)(new o.uA(q,t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw B("App Configuration");if(!t.name)throw B("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw B(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,r.j6)(e,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),(0,r.om)(new o.uA("installations-internal",t=>{const e=t.getProvider("app").getImmediate(),n=(0,r.j6)(e,q).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:r}=await x(e);return r?r.catch(console.error):V(e).catch(console.error),n.fid}(n),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await x(t);e&&await e}(n),(await V(n,e)).token}(n,t)}},"PRIVATE")),(0,r.KO)(c,u),(0,r.KO)(c,u,"esm2020");const $="analytics",z="https://www.googletagmanager.com/gtag/js",K=new s.Vy("@firebase/analytics"),G=new i.FA("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function H(t){if(!t.startsWith(z)){const e=G.create("invalid-gtag-resource",{gtagURL:t});return K.warn(e.message),""}return t}function Q(t){return Promise.all(t.map(t=>t.catch(t=>t)))}const W=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function X(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function J(t,e=W,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw G.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw G.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Z;return setTimeout(async()=>{a.abort()},void 0!==n?n:6e4),Y({appId:r,apiKey:s,measurementId:i},o,a,e)}async function Y(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=W){const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(G.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(r,e)}catch(t){if(a)return K.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${t?.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){const{appId:e,apiKey:n}=t,r={method:"GET",headers:X(n)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",e),i=await fetch(s,r);if(200!==i.status&&304!==i.status){let t="";try{const e=await i.json();e.error?.message&&(t=e.error.message)}catch(t){}throw G.create("config-fetch-failed",{httpStatus:i.status,responseMessage:t})}return i.json()}(t);return s.deleteThrottleMetadata(o),e}catch(e){const c=e;if(!function(t){if(!(t instanceof i.g&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(s.deleteThrottleMetadata(o),a)return K.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:a};throw e}const u=503===Number(c?.customData?.httpStatus)?(0,i.p9)(n,s.intervalMillis,30):(0,i.p9)(n,s.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return s.setThrottleMetadata(o,l),K.debug(`Calling attemptFetch again in ${u} millis`),Y(t,l,r,s)}}class Z{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let tt,et;async function nt(t,e,n,r,s,o,a){const c=J(t);c.then(e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&K.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(t=>K.error(t)),e.push(c);const u=async function(){if(!(0,i.zW)())return K.warn(G.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,i.eX)()}catch(t){return K.warn(G.create("indexeddb-unavailable",{errorInfo:t?.toString()}).message),!1}return!0}().then(t=>t?r.getId():void 0),[l,h]=await Promise.all([c,u]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(z)&&n.src.includes(t))return n;return null})(o)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:H}),r=document.createElement("script"),s=`${z}?l=${t}&id=${e}`;r.src=n?n?.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}(o,l.measurementId),et&&(s("consent","default",et),et=void 0),s("js",new Date);const d=a?.config??{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),s("config",l.measurementId,d),tt&&(s("set",tt),tt=void 0),l.measurementId}class rt{constructor(t){this.app=t}_delete(){return delete st[this.app.options.appId],Promise.resolve()}}let st={},it=[];const ot={};let at,ct,ut="dataLayer",lt=!1;function ht(t,e,n){!function(){const t=[];if((0,i.sr)()&&t.push("This is a browser extension environment."),(0,i.dM)()||t.push("Cookies are not available."),t.length>0){const e=t.map((t,e)=>`(${e+1}) ${t}`).join(" "),n=G.create("invalid-analytics-context",{errorInfo:e});K.warn(n.message)}}();const r=t.options.appId;if(!r)throw G.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw G.create("no-api-key");K.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=st[r])throw G.create("already-exists",{id:r});if(!lt){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ut);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,r,s){let i=function(...t){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function(t,e,n,r){return async function(s,...i){try{if("event"===s){const[r,s]=i;await async function(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let t=s.send_to;Array.isArray(t)||(t=[t]);const r=await Q(n);for(const n of t){const t=r.find(t=>t.measurementId===n),s=t&&e[t.appId];if(!s){i=[];break}i.push(s)}}0===i.length&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(t){K.error(t)}}(t,e,n,r,s)}else if("config"===s){const[s,o]=i;await async function(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const t=(await Q(n)).find(t=>t.measurementId===s);t&&await e[t.appId]}}catch(t){K.error(t)}t("config",s,i)}(t,e,n,r,s,o)}else if("consent"===s){const[e,n]=i;t("consent",e,n)}else if("get"===s){const[e,n,r]=i;t("get",e,n,r)}else if("set"===s){const[e]=i;t("set",e)}else t(s,...i)}catch(t){K.error(t)}}}(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}(st,it,ot,ut,"gtag");ct=t,at=e,lt=!0}return st[r]=nt(t,it,ot,e,at,ut,n),new rt(t)}function dt(t=(0,r.Sx)()){t=(0,i.Ku)(t);const e=(0,r.j6)(t,$);return e.isInitialized()?e.getImmediate():function(t,e={}){const n=(0,r.j6)(t,$);if(n.isInitialized()){const t=n.getImmediate();if((0,i.bD)(e,n.getOptions()))return t;throw G.create("already-initialized")}return n.initialize({options:e})}(t)}const ft="@firebase/analytics",pt="0.10.18";(0,r.om)(new o.uA($,(t,{options:e})=>ht(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),(0,r.om)(new o.uA("analytics-internal",function(t){try{const e=t.getProvider($).getImmediate();return{logEvent:(t,n,r)=>function(t,e,n,r){t=(0,i.Ku)(t),async function(t,e,n,r,s){if(s&&s.global)t("event",n,r);else{const s=await e;t("event",n,{...r,send_to:s})}}(ct,st[t.app.options.appId],e,n,r).catch(t=>K.error(t))}(e,t,n,r)}}catch(t){throw G.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,r.KO)(ft,pt),(0,r.KO)(ft,pt,"esm2020")},812:(t,e,n)=>{n.d(e,{$b:()=>s,Vy:()=>u});const r=[];var s;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));const i={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},o=s.INFO,a={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),s=a[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${r}]  ${t.name}:`,...n)};class u{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in s))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?i[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}},873:(t,e,n)=>{n.d(e,{h1:()=>a,uA:()=>s});var r=n(99);class s{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const i="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new r.cY;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(!this.isInitialized(e)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:e})}catch(t){if(n)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:i})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=i){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=i){return this.instances.has(t)}getOptions(t=i){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),r=this.onInitCallbacks.get(n)??new Set;r.add(t),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&t(s,n),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===i?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(t=i){return this.component?this.component.multipleInstances?t:i:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},913:(t,e,n)=>{n.d(e,{Wp:()=>r.Wp});var r=n(333);(0,r.KO)("firebase","12.2.1","app")},917:(t,e,n)=>{n.d(e,{A:()=>ve});var r={};function s(t,e){return function(){return t.apply(e,arguments)}}n.r(r),n.d(r,{hasBrowserEnv:()=>ft,hasStandardBrowserEnv:()=>mt,hasStandardBrowserWebWorkerEnv:()=>gt,navigator:()=>pt,origin:()=>yt});const{toString:i}=Object.prototype,{getPrototypeOf:o}=Object,{iterator:a,toStringTag:c}=Symbol,u=(l=Object.create(null),t=>{const e=i.call(t);return l[e]||(l[e]=e.slice(8,-1).toLowerCase())});var l;const h=t=>(t=t.toLowerCase(),e=>u(e)===t),d=t=>e=>typeof e===t,{isArray:f}=Array,p=d("undefined");function m(t){return null!==t&&!p(t)&&null!==t.constructor&&!p(t.constructor)&&w(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const g=h("ArrayBuffer"),y=d("string"),w=d("function"),v=d("number"),b=t=>null!==t&&"object"==typeof t,E=t=>{if("object"!==u(t))return!1;const e=o(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||c in t||a in t)},T=h("Date"),_=h("File"),S=h("Blob"),C=h("FileList"),I=h("URLSearchParams"),[A,D,N,k]=["ReadableStream","Request","Response","Headers"].map(h);function R(t,e,{allOwnKeys:n=!1}={}){if(null==t)return;let r,s;if("object"!=typeof t&&(t=[t]),f(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{if(m(t))return;const s=n?Object.getOwnPropertyNames(t):Object.keys(t),i=s.length;let o;for(r=0;r<i;r++)o=s[r],e.call(null,t[o],o,t)}}function O(t,e){if(m(t))return null;e=e.toLowerCase();const n=Object.keys(t);let r,s=n.length;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,L=t=>!p(t)&&t!==x,M=(P="undefined"!=typeof Uint8Array&&o(Uint8Array),t=>P&&t instanceof P);var P;const F=h("HTMLFormElement"),V=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),U=h("RegExp"),j=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};R(n,(n,s)=>{let i;!1!==(i=e(n,s,t))&&(r[s]=i||n)}),Object.defineProperties(t,r)},B=h("AsyncFunction"),q=($="function"==typeof setImmediate,z=w(x.postMessage),$?setImmediate:z?(K=`axios@${Math.random()}`,G=[],x.addEventListener("message",({source:t,data:e})=>{t===x&&e===K&&G.length&&G.shift()()},!1),t=>{G.push(t),x.postMessage(K,"*")}):t=>setTimeout(t));var $,z,K,G;const H="undefined"!=typeof queueMicrotask?queueMicrotask.bind(x):"undefined"!=typeof process&&process.nextTick||q,Q={isArray:f,isArrayBuffer:g,isBuffer:m,isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||w(t.append)&&("formdata"===(e=u(t))||"object"===e&&w(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&g(t.buffer),e},isString:y,isNumber:v,isBoolean:t=>!0===t||!1===t,isObject:b,isPlainObject:E,isEmptyObject:t=>{if(!b(t)||m(t))return!1;try{return 0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype}catch(t){return!1}},isReadableStream:A,isRequest:D,isResponse:N,isHeaders:k,isUndefined:p,isDate:T,isFile:_,isBlob:S,isRegExp:U,isFunction:w,isStream:t=>b(t)&&w(t.pipe),isURLSearchParams:I,isTypedArray:M,isFileList:C,forEach:R,merge:function t(){const{caseless:e,skipUndefined:n}=L(this)&&this||{},r={},s=(s,i)=>{const o=e&&O(r,i)||i;E(r[o])&&E(s)?r[o]=t(r[o],s):E(s)?r[o]=t({},s):f(s)?r[o]=s.slice():n&&p(s)||(r[o]=s)};for(let t=0,e=arguments.length;t<e;t++)arguments[t]&&R(arguments[t],s);return r},extend:(t,e,n,{allOwnKeys:r}={})=>(R(e,(e,r)=>{n&&w(e)?t[r]=s(e,n):t[r]=e},{allOwnKeys:r}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,r)=>{let s,i,a;const c={};if(e=e||{},null==t)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)a=s[i],r&&!r(a,t,e)||c[a]||(e[a]=t[a],c[a]=!0);t=!1!==n&&o(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:u,kindOfTest:h,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return-1!==r&&r===n},toArray:t=>{if(!t)return null;if(f(t))return t;let e=t.length;if(!v(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[a]).call(t);let r;for(;(r=n.next())&&!r.done;){const n=r.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const r=[];for(;null!==(n=t.exec(e));)r.push(n);return r},isHTMLForm:F,hasOwnProperty:V,hasOwnProp:V,reduceDescriptors:j,freezeMethods:t=>{j(t,(e,n)=>{if(w(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=t[n];w(r)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(t,e)=>{const n={},r=t=>{t.forEach(t=>{n[t]=!0})};return f(t)?r(t):r(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,n){return e.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:O,global:x,isContextDefined:L,isSpecCompliantForm:function(t){return!!(t&&w(t.append)&&"FormData"===t[c]&&t[a])},toJSONObject:t=>{const e=new Array(10),n=(t,r)=>{if(b(t)){if(e.indexOf(t)>=0)return;if(m(t))return t;if(!("toJSON"in t)){e[r]=t;const s=f(t)?[]:{};return R(t,(t,e)=>{const i=n(t,r+1);!p(i)&&(s[e]=i)}),e[r]=void 0,s}}return t};return n(t,0)},isAsyncFn:B,isThenable:t=>t&&(b(t)||w(t))&&w(t.then)&&w(t.catch),setImmediate:q,asap:H,isIterable:t=>null!=t&&w(t[a])};function W(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}Q.inherits(W,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Q.toJSONObject(this.config),code:this.code,status:this.status}}});const X=W.prototype,J={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{J[t]={value:t}}),Object.defineProperties(W,J),Object.defineProperty(X,"isAxiosError",{value:!0}),W.from=(t,e,n,r,s,i)=>{const o=Object.create(X);Q.toFlatObject(t,o,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t);const a=t&&t.message?t.message:"Error",c=null==e&&t?t.code:e;return W.call(o,a,c,n,r,s),t&&null==o.cause&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",i&&Object.assign(o,i),o};const Y=W;function Z(t){return Q.isPlainObject(t)||Q.isArray(t)}function tt(t){return Q.endsWith(t,"[]")?t.slice(0,-2):t}function et(t,e,n){return t?t.concat(e).map(function(t,e){return t=tt(t),!n&&e?"["+t+"]":t}).join(n?".":""):e}const nt=Q.toFlatObject(Q,{},null,function(t){return/^is[A-Z]/.test(t)}),rt=function(t,e,n){if(!Q.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const r=(n=Q.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!Q.isUndefined(e[t])})).metaTokens,s=n.visitor||u,i=n.dots,o=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Q.isSpecCompliantForm(e);if(!Q.isFunction(s))throw new TypeError("visitor must be a function");function c(t){if(null===t)return"";if(Q.isDate(t))return t.toISOString();if(Q.isBoolean(t))return t.toString();if(!a&&Q.isBlob(t))throw new Y("Blob is not supported. Use a Buffer instead.");return Q.isArrayBuffer(t)||Q.isTypedArray(t)?a&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function u(t,n,s){let a=t;if(t&&!s&&"object"==typeof t)if(Q.endsWith(n,"{}"))n=r?n:n.slice(0,-2),t=JSON.stringify(t);else if(Q.isArray(t)&&function(t){return Q.isArray(t)&&!t.some(Z)}(t)||(Q.isFileList(t)||Q.endsWith(n,"[]"))&&(a=Q.toArray(t)))return n=tt(n),a.forEach(function(t,r){!Q.isUndefined(t)&&null!==t&&e.append(!0===o?et([n],r,i):null===o?n:n+"[]",c(t))}),!1;return!!Z(t)||(e.append(et(s,n,i),c(t)),!1)}const l=[],h=Object.assign(nt,{defaultVisitor:u,convertValue:c,isVisitable:Z});if(!Q.isObject(t))throw new TypeError("data must be an object");return function t(n,r){if(!Q.isUndefined(n)){if(-1!==l.indexOf(n))throw Error("Circular reference detected in "+r.join("."));l.push(n),Q.forEach(n,function(n,i){!0===(!(Q.isUndefined(n)||null===n)&&s.call(e,n,Q.isString(i)?i.trim():i,r,h))&&t(n,r?r.concat(i):[i])}),l.pop()}}(t),e};function st(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function it(t,e){this._pairs=[],t&&rt(t,this,e)}const ot=it.prototype;ot.append=function(t,e){this._pairs.push([t,e])},ot.toString=function(t){const e=t?function(e){return t.call(this,e,st)}:st;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};const at=it;function ct(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ut(t,e,n){if(!e)return t;const r=n&&n.encode||ct;Q.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(i=s?s(e,n):Q.isURLSearchParams(e)?e.toString():new at(e,n).toString(r),i){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}const lt=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Q.forEach(this.handlers,function(e){null!==e&&t(e)})}},ht={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dt={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:at,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ft="undefined"!=typeof window&&"undefined"!=typeof document,pt="object"==typeof navigator&&navigator||void 0,mt=ft&&(!pt||["ReactNative","NativeScript","NS"].indexOf(pt.product)<0),gt="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,yt=ft&&window.location.href||"http://localhost",wt={...r,...dt},vt=function(t){function e(t,n,r,s){let i=t[s++];if("__proto__"===i)return!0;const o=Number.isFinite(+i),a=s>=t.length;return i=!i&&Q.isArray(r)?r.length:i,a?(Q.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o):(r[i]&&Q.isObject(r[i])||(r[i]=[]),e(t,n,r[i],s)&&Q.isArray(r[i])&&(r[i]=function(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}(r[i])),!o)}if(Q.isFormData(t)&&Q.isFunction(t.entries)){const n={};return Q.forEachEntry(t,(t,r)=>{e(function(t){return Q.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),r,n,0)}),n}return null},bt={transitional:ht,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",r=n.indexOf("application/json")>-1,s=Q.isObject(t);if(s&&Q.isHTMLForm(t)&&(t=new FormData(t)),Q.isFormData(t))return r?JSON.stringify(vt(t)):t;if(Q.isArrayBuffer(t)||Q.isBuffer(t)||Q.isStream(t)||Q.isFile(t)||Q.isBlob(t)||Q.isReadableStream(t))return t;if(Q.isArrayBufferView(t))return t.buffer;if(Q.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return rt(t,new wt.classes.URLSearchParams,{visitor:function(t,e,n,r){return wt.isNode&&Q.isBuffer(t)?(this.append(e,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...e})}(t,this.formSerializer).toString();if((i=Q.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return rt(i?{"files[]":t}:t,e&&new e,this.formSerializer)}}return s||r?(e.setContentType("application/json",!1),function(t){if(Q.isString(t))try{return(0,JSON.parse)(t),Q.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||bt.transitional,n=e&&e.forcedJSONParsing,r="json"===this.responseType;if(Q.isResponse(t)||Q.isReadableStream(t))return t;if(t&&Q.isString(t)&&(n&&!this.responseType||r)){const n=!(e&&e.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(t){if(n){if("SyntaxError"===t.name)throw Y.from(t,Y.ERR_BAD_RESPONSE,this,null,this.response);throw t}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:wt.classes.FormData,Blob:wt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Q.forEach(["delete","get","head","post","put","patch"],t=>{bt.headers[t]={}});const Et=bt,Tt=Q.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_t=Symbol("internals");function St(t){return t&&String(t).trim().toLowerCase()}function Ct(t){return!1===t||null==t?t:Q.isArray(t)?t.map(Ct):String(t)}function It(t,e,n,r,s){return Q.isFunction(r)?r.call(this,e,n):(s&&(e=n),Q.isString(e)?Q.isString(r)?-1!==e.indexOf(r):Q.isRegExp(r)?r.test(e):void 0:void 0)}class At{constructor(t){t&&this.set(t)}set(t,e,n){const r=this;function s(t,e,n){const s=St(e);if(!s)throw new Error("header name must be a non-empty string");const i=Q.findKey(r,s);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||e]=Ct(t))}const i=(t,e)=>Q.forEach(t,(t,n)=>s(t,n,e));if(Q.isPlainObject(t)||t instanceof this.constructor)i(t,e);else if(Q.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))i((t=>{const e={};let n,r,s;return t&&t.split("\n").forEach(function(t){s=t.indexOf(":"),n=t.substring(0,s).trim().toLowerCase(),r=t.substring(s+1).trim(),!n||e[n]&&Tt[n]||("set-cookie"===n?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e})(t),e);else if(Q.isObject(t)&&Q.isIterable(t)){let n,r,s={};for(const e of t){if(!Q.isArray(e))throw TypeError("Object iterator must return a key-value pair");s[r=e[0]]=(n=s[r])?Q.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}i(s,e)}else null!=t&&s(e,t,n);return this}get(t,e){if(t=St(t)){const n=Q.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}(t);if(Q.isFunction(e))return e.call(this,t,n);if(Q.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=St(t)){const n=Q.findKey(this,t);return!(!n||void 0===this[n]||e&&!It(0,this[n],n,e))}return!1}delete(t,e){const n=this;let r=!1;function s(t){if(t=St(t)){const s=Q.findKey(n,t);!s||e&&!It(0,n[s],s,e)||(delete n[s],r=!0)}}return Q.isArray(t)?t.forEach(s):s(t),r}clear(t){const e=Object.keys(this);let n=e.length,r=!1;for(;n--;){const s=e[n];t&&!It(0,this[s],s,t,!0)||(delete this[s],r=!0)}return r}normalize(t){const e=this,n={};return Q.forEach(this,(r,s)=>{const i=Q.findKey(n,s);if(i)return e[i]=Ct(r),void delete e[s];const o=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}(s):String(s).trim();o!==s&&delete e[s],e[o]=Ct(r),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return Q.forEach(this,(n,r)=>{null!=n&&!1!==n&&(e[r]=t&&Q.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(t=>n.set(t)),n}static accessor(t){const e=(this[_t]=this[_t]={accessors:{}}).accessors,n=this.prototype;function r(t){const r=St(t);e[r]||(function(t,e){const n=Q.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(t,n,s){return this[r].call(this,e,t,n,s)},configurable:!0})})}(n,t),e[r]=!0)}return Q.isArray(t)?t.forEach(r):r(t),this}}At.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Q.reduceDescriptors(At.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}}),Q.freezeMethods(At);const Dt=At;function Nt(t,e){const n=this||Et,r=e||n,s=Dt.from(r.headers);let i=r.data;return Q.forEach(t,function(t){i=t.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function kt(t){return!(!t||!t.__CANCEL__)}function Rt(t,e,n){Y.call(this,null==t?"canceled":t,Y.ERR_CANCELED,e,n),this.name="CanceledError"}Q.inherits(Rt,Y,{__CANCEL__:!0});const Ot=Rt;function xt(t,e,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(new Y("Request failed with status code "+n.status,[Y.ERR_BAD_REQUEST,Y.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}const Lt=(t,e,n=3)=>{let r=0;const s=function(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s,i=0,o=0;return e=void 0!==e?e:1e3,function(a){const c=Date.now(),u=r[o];s||(s=c),n[i]=a,r[i]=c;let l=o,h=0;for(;l!==i;)h+=n[l++],l%=t;if(i=(i+1)%t,i===o&&(o=(o+1)%t),c-s<e)return;const d=u&&c-u;return d?Math.round(1e3*h/d):void 0}}(50,250);return function(t,e){let n,r,s=0,i=1e3/e;const o=(e,i=Date.now())=>{s=i,n=null,r&&(clearTimeout(r),r=null),t(...e)};return[(...t)=>{const e=Date.now(),a=e-s;a>=i?o(t,e):(n=t,r||(r=setTimeout(()=>{r=null,o(n)},i-a)))},()=>n&&o(n)]}(n=>{const i=n.loaded,o=n.lengthComputable?n.total:void 0,a=i-r,c=s(a);r=i,t({loaded:i,total:o,progress:o?i/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&i<=o?(o-i)/c:void 0,event:n,lengthComputable:null!=o,[e?"download":"upload"]:!0})},n)},Mt=(t,e)=>{const n=null!=t;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Pt=t=>(...e)=>Q.asap(()=>t(...e)),Ft=wt.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,wt.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(wt.origin),wt.navigator&&/(msie|trident)/i.test(wt.navigator.userAgent)):()=>!0,Vt=wt.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];Q.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Q.isString(r)&&o.push("path="+r),Q.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ut(t,e,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(r||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const jt=t=>t instanceof Dt?{...t}:t;function Bt(t,e){e=e||{};const n={};function r(t,e,n,r){return Q.isPlainObject(t)&&Q.isPlainObject(e)?Q.merge.call({caseless:r},t,e):Q.isPlainObject(e)?Q.merge({},e):Q.isArray(e)?e.slice():e}function s(t,e,n,s){return Q.isUndefined(e)?Q.isUndefined(t)?void 0:r(void 0,t,0,s):r(t,e,0,s)}function i(t,e){if(!Q.isUndefined(e))return r(void 0,e)}function o(t,e){return Q.isUndefined(e)?Q.isUndefined(t)?void 0:r(void 0,t):r(void 0,e)}function a(n,s,i){return i in e?r(n,s):i in t?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(t,e,n)=>s(jt(t),jt(e),0,!0)};return Q.forEach(Object.keys({...t,...e}),function(r){const i=c[r]||s,o=i(t[r],e[r],r);Q.isUndefined(o)&&i!==a||(n[r]=o)}),n}const qt=t=>{const e=Bt({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;if(e.headers=o=Dt.from(o),e.url=ut(Ut(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),Q.isFormData(n))if(wt.hasStandardBrowserEnv||wt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Q.isFunction(n.getHeaders)){const t=n.getHeaders(),e=["content-type","content-length"];Object.entries(t).forEach(([t,n])=>{e.includes(t.toLowerCase())&&o.set(t,n)})}if(wt.hasStandardBrowserEnv&&(r&&Q.isFunction(r)&&(r=r(e)),r||!1!==r&&Ft(e.url))){const t=s&&i&&Vt.read(i);t&&o.set(s,t)}return e},$t="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise(function(e,n){const r=qt(t);let s=r.data;const i=Dt.from(r.headers).normalize();let o,a,c,u,l,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=r;function p(){u&&u(),l&&l(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=Dt.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());xt(function(t){e(t),p()},function(t){n(t),p()},{data:h&&"text"!==h&&"json"!==h?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:t,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new Y("Request aborted",Y.ECONNABORTED,t,m)),m=null)},m.onerror=function(e){const r=e&&e.message?e.message:"Network Error",s=new Y(r,Y.ERR_NETWORK,t,m);s.event=e||null,n(s),m=null},m.ontimeout=function(){let e=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const s=r.transitional||ht;r.timeoutErrorMessage&&(e=r.timeoutErrorMessage),n(new Y(e,s.clarifyTimeoutError?Y.ETIMEDOUT:Y.ECONNABORTED,t,m)),m=null},void 0===s&&i.setContentType(null),"setRequestHeader"in m&&Q.forEach(i.toJSON(),function(t,e){m.setRequestHeader(e,t)}),Q.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),h&&"json"!==h&&(m.responseType=r.responseType),f&&([c,l]=Lt(f,!0),m.addEventListener("progress",c)),d&&m.upload&&([a,u]=Lt(d),m.upload.addEventListener("progress",a),m.upload.addEventListener("loadend",u)),(r.cancelToken||r.signal)&&(o=e=>{m&&(n(!e||e.type?new Ot(null,t,m):e),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const y=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(r.url);y&&-1===wt.protocols.indexOf(y)?n(new Y("Unsupported protocol "+y+":",Y.ERR_BAD_REQUEST,t)):m.send(s||null)})},zt=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,r=new AbortController;const s=function(t){if(!n){n=!0,o();const e=t instanceof Error?t:this.reason;r.abort(e instanceof Y?e:new Ot(e instanceof Error?e.message:e))}};let i=e&&setTimeout(()=>{i=null,s(new Y(`timeout ${e} of ms exceeded`,Y.ETIMEDOUT))},e);const o=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(s):t.removeEventListener("abort",s)}),t=null)};t.forEach(t=>t.addEventListener("abort",s));const{signal:a}=r;return a.unsubscribe=()=>Q.asap(o),a}},Kt=function*(t,e){let n=t.byteLength;if(!e||n<e)return void(yield t);let r,s=0;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},Gt=(t,e,n,r)=>{const s=async function*(t,e){for await(const n of async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}}(t))yield*Kt(n,e)}(t,e);let i,o=0,a=t=>{i||(i=!0,r&&r(t))};return new ReadableStream({async pull(t){try{const{done:e,value:r}=await s.next();if(e)return a(),void t.close();let i=r.byteLength;if(n){let t=o+=i;n(t)}t.enqueue(new Uint8Array(r))}catch(t){throw a(t),t}},cancel:t=>(a(t),s.return())},{highWaterMark:2})},{isFunction:Ht}=Q,Qt=(({fetch:t,Request:e,Response:n})=>({fetch:t,Request:e,Response:n}))(Q.global),{ReadableStream:Wt,TextEncoder:Xt}=Q.global,Jt=(t,...e)=>{try{return!!t(...e)}catch(t){return!1}},Yt=t=>{const{fetch:e,Request:n,Response:r}=Object.assign({},Qt,t),s=Ht(e),i=Ht(n),o=Ht(r);if(!s)return!1;const a=s&&Ht(Wt),c=s&&("function"==typeof Xt?(u=new Xt,t=>u.encode(t)):async t=>new Uint8Array(await new n(t).arrayBuffer()));var u;const l=i&&a&&Jt(()=>{let t=!1;const e=new n(wt.origin,{body:new Wt,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),h=o&&a&&Jt(()=>Q.isReadableStream(new r("").body)),d={stream:h&&(t=>t.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!d[t]&&(d[t]=(e,n)=>{let r=e&&e[t];if(r)return r.call(e);throw new Y(`Response type '${t}' is not supported`,Y.ERR_NOT_SUPPORT,n)})});return async t=>{let{url:s,method:o,data:a,signal:u,cancelToken:f,timeout:p,onDownloadProgress:m,onUploadProgress:g,responseType:y,headers:w,withCredentials:v="same-origin",fetchOptions:b}=qt(t);y=y?(y+"").toLowerCase():"text";let E=zt([u,f&&f.toAbortSignal()],p),T=null;const _=E&&E.unsubscribe&&(()=>{E.unsubscribe()});let S;try{if(g&&l&&"get"!==o&&"head"!==o&&0!==(S=await(async(t,e)=>{const r=Q.toFiniteNumber(t.getContentLength());return null==r?(async t=>{if(null==t)return 0;if(Q.isBlob(t))return t.size;if(Q.isSpecCompliantForm(t)){const e=new n(wt.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return Q.isArrayBufferView(t)||Q.isArrayBuffer(t)?t.byteLength:(Q.isURLSearchParams(t)&&(t+=""),Q.isString(t)?(await c(t)).byteLength:void 0)})(e):r})(w,a))){let t,e=new n(s,{method:"POST",body:a,duplex:"half"});if(Q.isFormData(a)&&(t=e.headers.get("content-type"))&&w.setContentType(t),e.body){const[t,n]=Mt(S,Lt(Pt(g)));a=Gt(e.body,65536,t,n)}}Q.isString(v)||(v=v?"include":"omit");const u=i&&"credentials"in n.prototype,f={...b,signal:E,method:o.toUpperCase(),headers:w.normalize().toJSON(),body:a,duplex:"half",credentials:u?v:void 0};T=i&&new n(s,f);let p=await(i?e(T,b):e(s,f));const C=h&&("stream"===y||"response"===y);if(h&&(m||C&&_)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=p[e]});const e=Q.toFiniteNumber(p.headers.get("content-length")),[n,s]=m&&Mt(e,Lt(Pt(m),!0))||[];p=new r(Gt(p.body,65536,n,()=>{s&&s(),_&&_()}),t)}y=y||"text";let I=await d[Q.findKey(d,y)||"text"](p,t);return!C&&_&&_(),await new Promise((e,n)=>{xt(e,n,{data:I,headers:Dt.from(p.headers),status:p.status,statusText:p.statusText,config:t,request:T})})}catch(e){if(_&&_(),e&&"TypeError"===e.name&&/Load failed|fetch/i.test(e.message))throw Object.assign(new Y("Network Error",Y.ERR_NETWORK,t,T),{cause:e.cause||e});throw Y.from(e,e&&e.code,t,T)}}},Zt=new Map,te=t=>{let e=Q.merge.call({skipUndefined:!0},Qt,t?t.env:null);const{fetch:n,Request:r,Response:s}=e,i=[r,s,n];let o,a,c=i.length,u=Zt;for(;c--;)o=i[c],a=u.get(o),void 0===a&&u.set(o,a=c?new Map:Yt(e)),u=a;return a},ee=(te(),{http:null,xhr:$t,fetch:{get:te}});Q.forEach(ee,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(t){}Object.defineProperty(t,"adapterName",{value:e})}});const ne=t=>`- ${t}`,re=t=>Q.isFunction(t)||null===t||!1===t,se=(t,e)=>{t=Q.isArray(t)?t:[t];const{length:n}=t;let r,s;const i={};for(let o=0;o<n;o++){let n;if(r=t[o],s=r,!re(r)&&(s=ee[(n=String(r)).toLowerCase()],void 0===s))throw new Y(`Unknown adapter '${n}'`);if(s&&(Q.isFunction(s)||(s=s.get(e))))break;i[n||"#"+o]=s}if(!s){const t=Object.entries(i).map(([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build"));let e=n?t.length>1?"since :\n"+t.map(ne).join("\n"):" "+ne(t[0]):"as no adapter specified";throw new Y("There is no suitable adapter to dispatch the request "+e,"ERR_NOT_SUPPORT")}return s};function ie(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ot(null,t)}function oe(t){return ie(t),t.headers=Dt.from(t.headers),t.data=Nt.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),se(t.adapter||Et.adapter,t)(t).then(function(e){return ie(t),e.data=Nt.call(t,t.transformResponse,e),e.headers=Dt.from(e.headers),e},function(e){return kt(e)||(ie(t),e&&e.response&&(e.response.data=Nt.call(t,t.transformResponse,e.response),e.response.headers=Dt.from(e.response.headers))),Promise.reject(e)})}const ae="1.12.1",ce={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{ce[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const ue={};ce.transitional=function(t,e,n){function r(t,e){return"[Axios v"+ae+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,s,i)=>{if(!1===t)throw new Y(r(s," has been removed"+(e?" in "+e:"")),Y.ERR_DEPRECATED);return e&&!ue[s]&&(ue[s]=!0,console.warn(r(s," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,s,i)}},ce.spelling=function(t){return(e,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};const le={assertOptions:function(t,e,n){if("object"!=typeof t)throw new Y("options must be an object",Y.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const e=t[i],n=void 0===e||o(e,i,t);if(!0!==n)throw new Y("option "+i+" must be "+n,Y.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Y("Unknown option "+i,Y.ERR_BAD_OPTION)}},validators:ce},he=le.validators;class de{constructor(t){this.defaults=t||{},this.interceptors={request:new lt,response:new lt}}async request(t,e){try{return await this._request(t,e)}catch(t){if(t instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const n=e.stack?e.stack.replace(/^.+\n/,""):"";try{t.stack?n&&!String(t.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(t.stack+="\n"+n):t.stack=n}catch(t){}}throw t}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=Bt(this.defaults,e);const{transitional:n,paramsSerializer:r,headers:s}=e;void 0!==n&&le.assertOptions(n,{silentJSONParsing:he.transitional(he.boolean),forcedJSONParsing:he.transitional(he.boolean),clarifyTimeoutError:he.transitional(he.boolean)},!1),null!=r&&(Q.isFunction(r)?e.paramsSerializer={serialize:r}:le.assertOptions(r,{encode:he.function,serialize:he.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),le.assertOptions(e,{baseUrl:he.spelling("baseURL"),withXsrfToken:he.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let i=s&&Q.merge(s.common,s[e.method]);s&&Q.forEach(["delete","get","head","post","put","patch","common"],t=>{delete s[t]}),e.headers=Dt.concat(i,s);const o=[];let a=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,o.unshift(t.fulfilled,t.rejected))});const c=[];let u;this.interceptors.response.forEach(function(t){c.push(t.fulfilled,t.rejected)});let l,h=0;if(!a){const t=[oe.bind(this),void 0];for(t.unshift(...o),t.push(...c),l=t.length,u=Promise.resolve(e);h<l;)u=u.then(t[h++],t[h++]);return u}l=o.length;let d=e;for(h=0;h<l;){const t=o[h++],e=o[h++];try{d=t(d)}catch(t){e.call(this,t);break}}try{u=oe.call(this,d)}catch(t){return Promise.reject(t)}for(h=0,l=c.length;h<l;)u=u.then(c[h++],c[h++]);return u}getUri(t){return ut(Ut((t=Bt(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}}Q.forEach(["delete","get","head","options"],function(t){de.prototype[t]=function(e,n){return this.request(Bt(n||{},{method:t,url:e,data:(n||{}).data}))}}),Q.forEach(["post","put","patch"],function(t){function e(e){return function(n,r,s){return this.request(Bt(s||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}de.prototype[t]=e(),de.prototype[t+"Form"]=e(!0)});const fe=de;class pe{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const r=new Promise(t=>{n.subscribe(t),e=t}).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t(function(t,r,s){n.reason||(n.reason=new Ot(t,r,s),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new pe(function(e){t=e}),cancel:t}}}const me=pe,ge={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ge).forEach(([t,e])=>{ge[e]=t});const ye=ge,we=function t(e){const n=new fe(e),r=s(fe.prototype.request,n);return Q.extend(r,fe.prototype,n,{allOwnKeys:!0}),Q.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return t(Bt(e,n))},r}(Et);we.Axios=fe,we.CanceledError=Ot,we.CancelToken=me,we.isCancel=kt,we.VERSION=ae,we.toFormData=rt,we.AxiosError=Y,we.Cancel=we.CanceledError,we.all=function(t){return Promise.all(t)},we.spread=function(t){return function(e){return t.apply(null,e)}},we.isAxiosError=function(t){return Q.isObject(t)&&!0===t.isAxiosError},we.mergeConfig=Bt,we.AxiosHeaders=Dt,we.formToJSON=t=>vt(Q.isHTMLForm(t)?new FormData(t):t),we.getAdapter=se,we.HttpStatusCode=ye,we.default=we;const ve=we}},o={};function a(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return i[t](n,n.exports,a),n.exports}t="function"==typeof Symbol,e=t?Symbol("webpack queues"):"__webpack_queues__",n=t?Symbol("webpack exports"):"__webpack_exports__",r=t?Symbol("webpack error"):"__webpack_error__",s=t=>{t&&t.d<1&&(t.d=1,t.forEach(t=>t.r--),t.forEach(t=>t.r--?t.r++:t()))},a.a=(t,i,o)=>{var a;o&&((a=[]).d=-1);var c,u,l,h=new Set,d=t.exports,f=new Promise((t,e)=>{l=e,u=t});f[n]=d,f[e]=t=>(a&&t(a),h.forEach(t),f.catch(t=>{})),t.exports=f,i(t=>{var i;c=(t=>t.map(t=>{if(null!==t&&"object"==typeof t){if(t[e])return t;if(t.then){var i=[];i.d=0,t.then(t=>{o[n]=t,s(i)},t=>{o[r]=t,s(i)});var o={};return o[e]=t=>t(i),o}}var a={};return a[e]=t=>{},a[n]=t,a}))(t);var o=()=>c.map(t=>{if(t[r])throw t[r];return t[n]}),u=new Promise(t=>{(i=()=>t(o)).r=0;var n=t=>t!==a&&!h.has(t)&&(h.add(t),t&&!t.d&&(i.r++,t.push(i)));c.map(t=>t[e](n))});return i.r?u:o()},t=>(t?l(f[r]=t):u(d),s(a))),a&&a.d<0&&(a.d=0)},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a(334)})();